<!-- generated by the src2html.pl tool from code2ebook:
  https://github.com/agentzh/code2ebook
-->

<html>
 <head>
  <title>com/microsoft/spark/insight/cli/SparkAppPerfReportCli.scala - Spark Insight</title>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
  <style>
body {
    text-align: left;
    text-align-last: left;
}

code {
    font-family: consolas, monospace;
    line-height: 130%;
}


  </style>
 </head>
 <body>

  <h1>com/microsoft/spark/insight/cli/SparkAppPerfReportCli.scala - Spark Insight</h1>
 <h2>Data types defined</h2>
 <ul class="toc">
<li><a href="#L11">SparkAppPerfReportCli</a></li>
<li><a href="#L80">SparkAppPerfReportCli</a></li>
</ul>
 <h2>Functions defined</h2>
 <ul class="toc">
<li><a href="#L88">apply</a></li>
</ul>
 <h2>Source code</h2>

  <code>package com.microsoft.spark.insight.cli<br/>
<br/>
import com.microsoft.spark.insight.cli.frontend._<br/>
import com.microsoft.spark.insight.html.<a href="../html/SparkAppHtmlUtils.scala.html#L22" title="com/microsoft/spark/insight/html/SparkAppHtmlUtils.scala:22">SparkAppHtmlUtils</a>._<br/>
import com.microsoft.spark.insight.utils.PerfValue<br/>
import com.microsoft.spark.insight.utils.spark.<a href="../utils/spark/CommonStringUtils.scala.html#L8" title="com/microsoft/spark/insight/utils/spark/CommonStringUtils.scala:8">CommonStringUtils</a>.<a href="../utils/spark/CommonStringUtils.scala.html#L14" title="com/microsoft/spark/insight/utils/spark/CommonStringUtils.scala:14">extractWarnings</a><br/>
<br/>
/**<br/>
 * Generate a single app performance report given a Spark application run<br/>
 */<br/>
<a id="L11">&#x200c;</a>private[cli] class <span class="linkable">SparkAppPerfReportCli</span> private (withStages: Boolean)<br/>
&nbsp; &nbsp; extends <a href="PerfMetricsReport.scala.html#L149" title="com/microsoft/spark/insight/cli/PerfMetricsReport.scala:149">PerfMetricsReport</a>[PerfValue](withStages)<br/>
&nbsp; &nbsp; with <a href="ReportCli.scala.html#L10" title="com/microsoft/spark/insight/cli/ReportCli.scala:10">ReportCli</a>[<a href="AppIdSets.scala.html#L13" title="com/microsoft/spark/insight/cli/AppIdSets.scala:13">AppId</a>] {<br/>
<br/>
&nbsp; override def <a href="PerfMetricsReport.scala.html#L33" title="com/microsoft/spark/insight/cli/PerfMetricsReport.scala:33">headerDefinition</a>: Array[String] = Array(&quot;Metric <a href="../fetcher/status/statusapiv1.scala.html#L48" title="com/microsoft/spark/insight/fetcher/status/statusapiv1.scala:48">name</a>&quot;, &quot;Value&quot;, &quot;Metric <a href="../fetcher/status/statusapiv1.scala.html#L106" title="com/microsoft/spark/insight/fetcher/status/statusapiv1.scala:106">description</a>&quot;)<br/>
<br/>
&nbsp; /**<br/>
&nbsp;&nbsp; * Generate Text version of Spark performance report, leveraging<br/>
&nbsp;&nbsp; * [[com.microsoft.spark.insight.utils.spark.<a href="../utils/spark/SparkAppPerfReport.scala.html#L26" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfReport.scala:26">SparkAppPerfReport</a>]]<br/>
&nbsp;&nbsp; *<br/>
&nbsp;&nbsp; * @param singleAppReport a single [[com.microsoft.spark.insight.utils.spark.<a href="../utils/spark/SparkAppPerfReport.scala.html#L26" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfReport.scala:26">SparkAppPerfReport</a>]]<br/>
&nbsp;&nbsp; * @return performance report<br/>
&nbsp;&nbsp; */<br/>
&nbsp; override protected def <a href="TextReport.scala.html#L35" title="com/microsoft/spark/insight/cli/TextReport.scala:35">genTextReportBody</a>[U &lt;: <a href="AppReportSets.scala.html#L11" title="com/microsoft/spark/insight/cli/AppReportSets.scala:11">AppReportSets</a>[<a href="AppIdSets.scala.html#L13" title="com/microsoft/spark/insight/cli/AppIdSets.scala:13">AppId</a>]](singleAppReport: U): String = {<br/>
&nbsp; &nbsp; val appReport = singleAppReport.appReport<br/>
&nbsp; &nbsp; val sb = new StringBuilder()<br/>
<br/>
&nbsp; &nbsp; sb.<a href="frontend/CliTable.scala.html#L56" title="com/microsoft/spark/insight/cli/frontend/CliTable.scala:56">append</a>(s&quot;\<a href="../utils/AggregatePerfValue.scala.html#L28" title="com/microsoft/spark/insight/utils/AggregatePerfValue.scala:28">n</a>${<a href="ReportCli.scala.html#L10" title="com/microsoft/spark/insight/cli/ReportCli.scala:10">ReportCli</a>.<a href="ReportCli.scala.html#L22" title="com/microsoft/spark/insight/cli/ReportCli.scala:22">firstLineNote</a>}\<a href="../utils/AggregatePerfValue.scala.html#L28" title="com/microsoft/spark/insight/utils/AggregatePerfValue.scala:28">n</a>\<a href="../utils/AggregatePerfValue.scala.html#L28" title="com/microsoft/spark/insight/utils/AggregatePerfValue.scala:28">n</a>&quot;)<br/>
<br/>
&nbsp; &nbsp; sb.<a href="frontend/CliTable.scala.html#L56" title="com/microsoft/spark/insight/cli/frontend/CliTable.scala:56">append</a>(s&quot;Spark Application Performance Report for applicationId: ${appReport.rawSparkMetrics.<a href="../utils/spark/RawSparkMetrics.scala.html#L31" title="com/microsoft/spark/insight/utils/spark/RawSparkMetrics.scala:31">appId</a>}\<a href="../utils/AggregatePerfValue.scala.html#L28" title="com/microsoft/spark/insight/utils/AggregatePerfValue.scala:28">n</a>&quot;)<br/>
<br/>
&nbsp; &nbsp; <a href="../utils/spark/CommonStringUtils.scala.html#L14" title="com/microsoft/spark/insight/utils/spark/CommonStringUtils.scala:14">extractWarnings</a>(appReport).foreach(warning =&gt; sb.<a href="frontend/CliTable.scala.html#L56" title="com/microsoft/spark/insight/cli/frontend/CliTable.scala:56">append</a>(s&quot;${&quot;Warning:&quot;.<a href="frontend/package.scala.html#L30" title="com/microsoft/spark/insight/cli/frontend/package.scala:30">red</a>.<a href="frontend/package.scala.html#L60" title="com/microsoft/spark/insight/cli/frontend/package.scala:60">underlined</a>} $warning&quot;))<br/>
&nbsp; &nbsp; sb.<a href="frontend/CliTable.scala.html#L56" title="com/microsoft/spark/insight/cli/frontend/CliTable.scala:56">append</a>(s&quot;\nSummarized metrics for all of the jobs:\<a href="../utils/AggregatePerfValue.scala.html#L28" title="com/microsoft/spark/insight/utils/AggregatePerfValue.scala:28">n</a>&quot;)<br/>
<br/>
&nbsp; &nbsp; val summaryTable = <a href="PerfMetricsReport.scala.html#L65" title="com/microsoft/spark/insight/cli/PerfMetricsReport.scala:65">buildMetricsTable</a>(appReport.<a href="../utils/spark/SparkAppPerfReportBase.scala.html#L63" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfReportBase.scala:63">summaryReport</a>, <a href="PerfMetricsReport.scala.html#L40" title="com/microsoft/spark/insight/cli/PerfMetricsReport.scala:40">tableSummaryHeader</a>)<br/>
&nbsp; &nbsp; sb.<a href="frontend/CliTable.scala.html#L56" title="com/microsoft/spark/insight/cli/frontend/CliTable.scala:56">append</a>(summaryTable)<br/>
&nbsp; &nbsp; sb.<a href="frontend/CliTable.scala.html#L56" title="com/microsoft/spark/insight/cli/frontend/CliTable.scala:56">append</a>(String.<a href="../heuristics/StageAnalyzer.scala.html#L39" title="com/microsoft/spark/insight/heuristics/StageAnalyzer.scala:39">format</a>(&quot;~&quot; * 136) + &quot;\<a href="../utils/AggregatePerfValue.scala.html#L28" title="com/microsoft/spark/insight/utils/AggregatePerfValue.scala:28">n</a>&quot;)<br/>
<br/>
&nbsp; &nbsp; // Perform every <a href="../utils/spark/PerStageReport.scala.html#L26" title="com/microsoft/spark/insight/utils/spark/PerStageReport.scala:26">stage</a>'s performance report<br/>
&nbsp; &nbsp; sb.<a href="frontend/CliTable.scala.html#L56" title="com/microsoft/spark/insight/cli/frontend/CliTable.scala:56">append</a>(<br/>
&nbsp; &nbsp; &nbsp; <a href="PerfMetricsReport.scala.html#L101" title="com/microsoft/spark/insight/cli/PerfMetricsReport.scala:101">buildPerStageTables</a>(<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &quot;Metrics for individual jobs&quot;,<br/>
&nbsp; &nbsp; &nbsp; &nbsp; appReport.<a href="../utils/spark/SparkAppPerfReportBase.scala.html#L70" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfReportBase.scala:70">jobLevelReport</a>,<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &quot;Metrics for individual stages&quot;,<br/>
&nbsp; &nbsp; &nbsp; &nbsp; appReport.<a href="../utils/spark/SparkAppPerfReportBase.scala.html#L56" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfReportBase.scala:56">perJobReport</a>))<br/>
&nbsp; &nbsp; sb.<a href="frontend/CliTable.scala.html#L56" title="com/microsoft/spark/insight/cli/frontend/CliTable.scala:56">append</a>(<a href="ReportCli.scala.html#L10" title="com/microsoft/spark/insight/cli/ReportCli.scala:10">ReportCli</a>.<a href="ReportCli.scala.html#L30" title="com/microsoft/spark/insight/cli/ReportCli.scala:30">htmlNote</a>)<br/>
<br/>
&nbsp; &nbsp; sb.toString<br/>
&nbsp; }<br/>
<br/>
&nbsp; override protected def <a href="PerfMetricsReport.scala.html#L26" title="com/microsoft/spark/insight/cli/PerfMetricsReport.scala:26">buildPerfTableRowValues</a>(<a href="../fetcher/status/statusapiv1.scala.html#L305" title="com/microsoft/spark/insight/fetcher/status/statusapiv1.scala:305">value</a>: PerfValue, transformer: Double =&gt; String): Array[String] =<br/>
&nbsp; &nbsp; Array(transformer(<a href="../fetcher/status/statusapiv1.scala.html#L305" title="com/microsoft/spark/insight/fetcher/status/statusapiv1.scala:305">value</a>))<br/>
<br/>
&nbsp; /**<br/>
&nbsp;&nbsp; * Generate Html version of Spark performance report, leveraging<br/>
&nbsp;&nbsp; * [[com.microsoft.spark.insight.utils.spark.<a href="../utils/spark/SparkAppPerfReport.scala.html#L26" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfReport.scala:26">SparkAppPerfReport</a>]]<br/>
&nbsp;&nbsp; *<br/>
&nbsp;&nbsp; * @param singleAppReport a single [[com.microsoft.spark.insight.utils.spark.<a href="../utils/spark/SparkAppPerfReport.scala.html#L26" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfReport.scala:26">SparkAppPerfReport</a>]]<br/>
&nbsp;&nbsp; * @return String containing path to Html File.<br/>
&nbsp;&nbsp; */<br/>
&nbsp; override protected def <a href="HtmlReport.scala.html#L35" title="com/microsoft/spark/insight/cli/HtmlReport.scala:35">genHtmlReportFile</a>[U &lt;: <a href="AppReportSets.scala.html#L11" title="com/microsoft/spark/insight/cli/AppReportSets.scala:11">AppReportSets</a>[<a href="AppIdSets.scala.html#L13" title="com/microsoft/spark/insight/cli/AppIdSets.scala:13">AppId</a>]](singleAppReport: U): String = {<br/>
&nbsp; &nbsp; val appReport = singleAppReport.appReport<br/>
&nbsp; &nbsp; val sb = new StringBuilder()<br/>
<br/>
&nbsp; &nbsp; sb.<a href="frontend/CliTable.scala.html#L56" title="com/microsoft/spark/insight/cli/frontend/CliTable.scala:56">append</a>(s&quot;\nSpark Application Performance Report for applicationId: ${appReport.rawSparkMetrics.<a href="../utils/spark/RawSparkMetrics.scala.html#L31" title="com/microsoft/spark/insight/utils/spark/RawSparkMetrics.scala:31">appId</a>}\<a href="../utils/AggregatePerfValue.scala.html#L28" title="com/microsoft/spark/insight/utils/AggregatePerfValue.scala:28">n</a>&quot;)<br/>
<br/>
&nbsp; &nbsp; // <a href="../html/SparkAppHtmlUtils.scala.html#L31" title="com/microsoft/spark/insight/html/SparkAppHtmlUtils.scala:31">writeAndOpenHtml</a> creates a new views.html file named '<a href="../utils/spark/RawSparkMetrics.scala.html#L31" title="com/microsoft/spark/insight/utils/spark/RawSparkMetrics.scala:31">appId</a>',<br/>
&nbsp; &nbsp; // writes the rendered views.html output, opens file in browser and returns path to file<br/>
&nbsp; &nbsp; try {<br/>
&nbsp; &nbsp; &nbsp; val htmlFilePath = &quot;empty&quot;<br/>
&nbsp; &nbsp; &nbsp; sb.<a href="frontend/CliTable.scala.html#L56" title="com/microsoft/spark/insight/cli/frontend/CliTable.scala:56">append</a>(s&quot;\nHTML report was written to: $htmlFilePath&quot;.<a href="frontend/package.scala.html#L39" title="com/microsoft/spark/insight/cli/frontend/package.scala:39">blue</a>.<a href="frontend/package.scala.html#L57" title="com/microsoft/spark/insight/cli/frontend/package.scala:57">bold</a>)<br/>
&nbsp; &nbsp; } catch {<br/>
&nbsp; &nbsp; &nbsp; case e: Exception =&gt; sb.<a href="frontend/CliTable.scala.html#L56" title="com/microsoft/spark/insight/cli/frontend/CliTable.scala:56">append</a>(s&quot;\nGenerating Html report failed. Reason: $e&quot;)<br/>
&nbsp; &nbsp; }<br/>
<br/>
&nbsp; &nbsp; sb.toString<br/>
&nbsp; }<br/>
}<br/>
<br/>
<a id="L80">&#x200c;</a>object <span class="linkable">SparkAppPerfReportCli</span> {<br/>
<br/>
&nbsp; /**<br/>
&nbsp;&nbsp; * The public API to build single app performance report given one <a href="../utils/spark/RawSparkMetrics.scala.html#L31" title="com/microsoft/spark/insight/utils/spark/RawSparkMetrics.scala:31">appId</a><br/>
&nbsp;&nbsp; *<br/>
&nbsp;&nbsp; * @param withStages true or false to show per-stages metrics<br/>
&nbsp;&nbsp; * @return a cli instance used to generate app performance report<br/>
&nbsp;&nbsp; */<br/>
<a id="L88">&#x200c;</a>&nbsp; def <span class="linkable">apply</span>(withStages: Boolean): <a href="#L11" title="com/microsoft/spark/insight/cli/SparkAppPerfReportCli.scala:11">SparkAppPerfReportCli</a> = new <a href="#L11" title="com/microsoft/spark/insight/cli/SparkAppPerfReportCli.scala:11">SparkAppPerfReportCli</a>(withStages)<br/>
}<br/>
</code>

 </body>
</html>
