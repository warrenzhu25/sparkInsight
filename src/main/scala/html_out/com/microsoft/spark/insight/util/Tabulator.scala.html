<!-- generated by the src2html.pl tool from code2ebook:
  https://github.com/agentzh/code2ebook
-->

<html>
 <head>
  <title>com/microsoft/spark/insight/util/Tabulator.scala - Spark Insight</title>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
  <style>
body {
    text-align: left;
    text-align-last: left;
}

code {
    font-family: consolas, monospace;
    line-height: 130%;
}


  </style>
 </head>
 <body>

  <h1>com/microsoft/spark/insight/util/Tabulator.scala - Spark Insight</h1>
 <h2>Data types defined</h2>
 <ul class="toc">
<li><a href="#L20">Tabulator</a></li>
</ul>
 <h2>Functions defined</h2>
 <ul class="toc">
<li><a href="#L21">format</a></li>
<li><a href="#L39">formatRow</a></li>
<li><a href="#L31">formatRows</a></li>
<li><a href="#L45">rowSeparator</a></li>
</ul>
 <h2>Source code</h2>

  <code>/*<br/>
 * Licensed to the Apache Software Foundation (ASF) under one or more<br/>
 * contributor license agreements.&nbsp; See the NOTICE file distributed with<br/>
 * this work for additional information regarding copyright ownership.<br/>
 * The ASF licenses this file to You under the Apache License, Version 2.0<br/>
 * (the &quot;License&quot;); you may not use this file except in compliance with<br/>
 * the License.&nbsp; You may obtain a copy of the License at<br/>
 *<br/>
 *&nbsp; &nbsp; http://www.apache.org/licenses/LICENSE-2.0<br/>
 *<br/>
 * Unless required by applicable law or agreed to in writing, software<br/>
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,<br/>
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.<br/>
 * See the License for the specific language governing permissions and<br/>
 * limitations under the License.<br/>
 */<br/>
<br/>
package com.microsoft.spark.insight.util<br/>
<br/>
<a id="L20">&#x200c;</a>object <span class="linkable">Tabulator</span> {<br/>
<a id="L21">&#x200c;</a>&nbsp; def <span class="linkable">format</span>(table: Seq[Seq[Any]]): String = table match {<br/>
&nbsp; &nbsp; case Seq() =&gt; &quot;&quot;<br/>
&nbsp; &nbsp; case _ =&gt;<br/>
&nbsp; &nbsp; &nbsp; val sizes = for (row &lt;- table) yield (for (cell &lt;- row)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; yield if (cell == null) 0 else cell.toString.length)<br/>
&nbsp; &nbsp; &nbsp; val colSizes = for (col &lt;- sizes.transpose) yield col.<a href="../utils/AggregatePerfValue.scala.html#L26" title="com/microsoft/spark/insight/utils/AggregatePerfValue.scala:26">max</a><br/>
&nbsp; &nbsp; &nbsp; val <a href="../heuristics/HeuristicResult.scala.html#L25" title="com/microsoft/spark/insight/heuristics/HeuristicResult.scala:25">rows</a> = for (row &lt;- table) yield <a href="#L39" title="com/microsoft/spark/insight/util/Tabulator.scala:39">formatRow</a>(row, colSizes)<br/>
&nbsp; &nbsp; &nbsp; <a href="#L31" title="com/microsoft/spark/insight/util/Tabulator.scala:31">formatRows</a>(<a href="#L45" title="com/microsoft/spark/insight/util/Tabulator.scala:45">rowSeparator</a>(colSizes), <a href="../heuristics/HeuristicResult.scala.html#L25" title="com/microsoft/spark/insight/heuristics/HeuristicResult.scala:25">rows</a>)<br/>
&nbsp; }<br/>
<br/>
<a id="L31">&#x200c;</a>&nbsp; private def <span class="linkable">formatRows</span>(<a href="#L45" title="com/microsoft/spark/insight/util/Tabulator.scala:45">rowSeparator</a>: String, <a href="../heuristics/HeuristicResult.scala.html#L25" title="com/microsoft/spark/insight/heuristics/HeuristicResult.scala:25">rows</a>: Seq[String]): String = (<br/>
&nbsp; &nbsp; <a href="#L45" title="com/microsoft/spark/insight/util/Tabulator.scala:45">rowSeparator</a> ::<br/>
&nbsp; &nbsp; <a href="../heuristics/HeuristicResult.scala.html#L25" title="com/microsoft/spark/insight/heuristics/HeuristicResult.scala:25">rows</a>.head ::<br/>
&nbsp; &nbsp; <a href="#L45" title="com/microsoft/spark/insight/util/Tabulator.scala:45">rowSeparator</a> ::<br/>
&nbsp; &nbsp; <a href="../heuristics/HeuristicResult.scala.html#L25" title="com/microsoft/spark/insight/heuristics/HeuristicResult.scala:25">rows</a>.tail.toList :::<br/>
&nbsp; &nbsp; <a href="#L45" title="com/microsoft/spark/insight/util/Tabulator.scala:45">rowSeparator</a> ::<br/>
&nbsp; &nbsp; List()).mkString(&quot;\<a href="../utils/AggregatePerfValue.scala.html#L28" title="com/microsoft/spark/insight/utils/AggregatePerfValue.scala:28">n</a>&quot;)<br/>
<br/>
<a id="L39">&#x200c;</a>&nbsp; private def <span class="linkable">formatRow</span>(row: Seq[Any], colSizes: Seq[Int]): String = {<br/>
&nbsp; &nbsp; val cells = for ((item, size) &lt;- row.zip(colSizes))<br/>
&nbsp; &nbsp; &nbsp; yield if (size == 0) &quot;&quot; else (&quot;%&quot; + size + &quot;s&quot;).<a href="../heuristics/StageAnalyzer.scala.html#L39" title="com/microsoft/spark/insight/heuristics/StageAnalyzer.scala:39">format</a>(item)<br/>
&nbsp; &nbsp; cells.mkString(&quot;|&quot;, &quot;|&quot;, &quot;|&quot;)<br/>
&nbsp; }<br/>
<br/>
<a id="L45">&#x200c;</a>&nbsp; private def <span class="linkable">rowSeparator</span>(colSizes: Seq[Int]): String =<br/>
&nbsp; &nbsp; colSizes map { &quot;-&quot; * _ } mkString(&quot;+&quot;, &quot;+&quot;, &quot;+&quot;)<br/>
}</code>

 </body>
</html>
