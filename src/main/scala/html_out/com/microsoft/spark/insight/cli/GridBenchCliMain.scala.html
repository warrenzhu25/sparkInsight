<!-- generated by the src2html.pl tool from code2ebook:
  https://github.com/agentzh/code2ebook
-->

<html>
 <head>
  <title>com/microsoft/spark/insight/cli/GridBenchCliMain.scala - Spark Insight</title>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
  <style>
body {
    text-align: left;
    text-align-last: left;
}

code {
    font-family: consolas, monospace;
    line-height: 130%;
}


  </style>
 </head>
 <body>

  <h1>com/microsoft/spark/insight/cli/GridBenchCliMain.scala - Spark Insight</h1>
 <h2>Data types defined</h2>
 <ul class="toc">
<li><a href="#L18">GridBenchCliMain</a></li>
</ul>
 <h2>Source code</h2>

  <code>package com.microsoft.spark.insight.cli<br/>
<br/>
import java.net.URI<br/>
import java.util.concurrent.TimeUnit<br/>
<br/>
import com.microsoft.spark.insight.cli.argument.{<a href="argument/ArgumentConf.scala.html#L12" title="com/microsoft/spark/insight/cli/argument/ArgumentConf.scala:12">ArgumentConf</a>, <a href="argument/ReportGeneration.scala.html#L8" title="com/microsoft/spark/insight/cli/argument/ReportGeneration.scala:8">ReportGeneration</a>}<br/>
import com.microsoft.spark.insight.cli.frontend._<br/>
import com.microsoft.spark.insight.utils.spark.<a href="../utils/spark/CommonStringUtils.scala.html#L8" title="com/microsoft/spark/insight/utils/spark/CommonStringUtils.scala:8">CommonStringUtils</a>.{FEEDBACK_LINK, FEEDBACK_LINK_TEMPLATE}<br/>
import com.microsoft.spark.insight.utils.spark.<a href="../utils/spark/SparkHistoryServerMetricsRetriever.scala.html#L14" title="com/microsoft/spark/insight/utils/spark/SparkHistoryServerMetricsRetriever.scala:14">SparkHistoryServerMetricsRetriever</a><br/>
import org.rogach.scallop.exceptions.ScallopException<br/>
import org.slf4j.{Logger, LoggerFactory}<br/>
<br/>
import scala.concurrent.duration.Duration<br/>
<br/>
/**<br/>
 * The entry point to GridBench CLI. Usage can be found in the DocIN documentation<br/>
 */<br/>
<a id="L18">&#x200c;</a>object <span class="linkable">GridBenchCliMain</span> extends App {<br/>
&nbsp; val LOGGER: Logger = LoggerFactory.getLogger(<a href="#L18" title="com/microsoft/spark/insight/cli/GridBenchCliMain.scala:18">GridBenchCliMain</a>.getClass)<br/>
<br/>
&nbsp; private val cliVersion = <a href="#L18" title="com/microsoft/spark/insight/cli/GridBenchCliMain.scala:18">GridBenchCliMain</a>.getClass.getPackage.getImplementationVersion<br/>
<br/>
&nbsp; private val versionInfo = cliVersion match {<br/>
&nbsp; &nbsp; case version: String =&gt; s&quot;GridBench CLI Version: $version&quot;<br/>
&nbsp; &nbsp; case _ =&gt; &quot;No Version&quot;<br/>
&nbsp; }<br/>
<br/>
&nbsp; private val userHomePath = System.<a href="../heuristics/ConfigurationHeuristic.scala.html#L48" title="com/microsoft/spark/insight/heuristics/ConfigurationHeuristic.scala:48">getProperty</a>(&quot;user.home&quot;)<br/>
&nbsp; println(s&quot;Logging detailed information to $userHomePath/.gridbench/gridbench-cli.log\<a href="../utils/AggregatePerfValue.scala.html#L28" title="com/microsoft/spark/insight/utils/AggregatePerfValue.scala:28">n</a>$versionInfo\<a href="../utils/AggregatePerfValue.scala.html#L28" title="com/microsoft/spark/insight/utils/AggregatePerfValue.scala:28">n</a>&quot;)<br/>
&nbsp; LOGGER.info(s&quot;$versionInfo&quot;)<br/>
<br/>
&nbsp; private val <a href="../fetcher/status/statusapiv1.scala.html#L60" title="com/microsoft/spark/insight/fetcher/status/statusapiv1.scala:60">startTime</a> = System.currentTimeMillis<br/>
<br/>
&nbsp; private var argumentConf: Option[<a href="argument/ArgumentConf.scala.html#L12" title="com/microsoft/spark/insight/cli/argument/ArgumentConf.scala:12">ArgumentConf</a>] = None<br/>
<br/>
&nbsp; private val result: Either[Int, Exception] =<br/>
&nbsp; &nbsp; try {<br/>
&nbsp; &nbsp; &nbsp; val argConf = <a href="argument/ArgumentConf.scala.html#L12" title="com/microsoft/spark/insight/cli/argument/ArgumentConf.scala:12">ArgumentConf</a>(args)<br/>
&nbsp; &nbsp; &nbsp; argumentConf = Option(argConf)<br/>
<br/>
&nbsp; &nbsp; &nbsp; // If the user specifies version option, Cli program returns immediately<br/>
&nbsp; &nbsp; &nbsp; if (argConf.version()) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; Left(0)<br/>
&nbsp; &nbsp; &nbsp; } else {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; // parse SHS url addr from user input<br/>
&nbsp; &nbsp; &nbsp; &nbsp; val shsURL = <a href="GridBenchCliUtil.scala.html#L6" title="com/microsoft/spark/insight/cli/GridBenchCliUtil.scala:6">GridBenchCliUtil</a>.<a href="GridBenchCliUtil.scala.html#L60" title="com/microsoft/spark/insight/cli/GridBenchCliUtil.scala:60">constructShsUrl</a>(argConf.shsEndpoint())<br/>
&nbsp; &nbsp; &nbsp; &nbsp; implicit val sparkMetricsRetriever: <a href="../utils/spark/SparkHistoryServerMetricsRetriever.scala.html#L14" title="com/microsoft/spark/insight/utils/spark/SparkHistoryServerMetricsRetriever.scala:14">SparkHistoryServerMetricsRetriever</a> =<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; new <a href="../utils/spark/SparkHistoryServerMetricsRetriever.scala.html#L14" title="com/microsoft/spark/insight/utils/spark/SparkHistoryServerMetricsRetriever.scala:14">SparkHistoryServerMetricsRetriever</a>(new URI(shsURL))<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; // Match sub command to trigger different service<br/>
&nbsp; &nbsp; &nbsp; &nbsp; argConf.subcommand match {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case Some(subcommand: <a href="argument/ReportGeneration.scala.html#L8" title="com/microsoft/spark/insight/cli/argument/ReportGeneration.scala:8">ReportGeneration</a>) =&gt;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; val output = subcommand.<a href="argument/ReportGeneration.scala.html#L16" title="com/microsoft/spark/insight/cli/argument/ReportGeneration.scala:16">genReport</a><br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; println(output)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Left(output.length)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case _ =&gt;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; argConf.printHelp()<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Left(0)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
&nbsp; &nbsp; &nbsp; }<br/>
&nbsp; &nbsp; } catch {<br/>
&nbsp; &nbsp; &nbsp; case e: Exception =&gt;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; val message = s&quot;GridBench CLI failed. Reason: $e&quot;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; if (!e.isInstanceOf[ScallopException]) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Silence these known exceptions, as we don't want users to receive meaningless stack traces, but still log<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; println(s&quot;[Error] \u274C $message&quot;)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
&nbsp; &nbsp; &nbsp; &nbsp; LOGGER.error(message)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; Right(e)<br/>
&nbsp; &nbsp; }<br/>
<br/>
&nbsp; private val duration = Duration(System.currentTimeMillis - <a href="../fetcher/status/statusapiv1.scala.html#L60" title="com/microsoft/spark/insight/fetcher/status/statusapiv1.scala:60">startTime</a>, TimeUnit.MILLISECONDS)<br/>
&nbsp; println(s&quot;\nTotal processing time: ${duration.toSeconds} seconds&quot;)<br/>
&nbsp; println(s&quot;$FEEDBACK_LINK_TEMPLATE ${FEEDBACK_LINK.<a href="frontend/package.scala.html#L39" title="com/microsoft/spark/insight/cli/frontend/package.scala:39">blue</a>.<a href="frontend/package.scala.html#L57" title="com/microsoft/spark/insight/cli/frontend/package.scala:57">bold</a>}&quot;)<br/>
<br/>
&nbsp; // Empty out the buffer to the cli screen<br/>
&nbsp; Console.out.flush()<br/>
<br/>
}<br/>
</code>

 </body>
</html>
