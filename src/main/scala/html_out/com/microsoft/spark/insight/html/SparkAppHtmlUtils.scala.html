<!-- generated by the src2html.pl tool from code2ebook:
  https://github.com/agentzh/code2ebook
-->

<html>
 <head>
  <title>com/microsoft/spark/insight/html/SparkAppHtmlUtils.scala - Spark Insight</title>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
  <style>
body {
    text-align: left;
    text-align-last: left;
}

code {
    font-family: consolas, monospace;
    line-height: 130%;
}


  </style>
 </head>
 <body>

  <h1>com/microsoft/spark/insight/html/SparkAppHtmlUtils.scala - Spark Insight</h1>
 <h2>Data types defined</h2>
 <ul class="toc">
<li><a href="#L22">SparkAppHtmlUtils</a></li>
</ul>
 <h2>Functions defined</h2>
 <ul class="toc">
<li><a href="#L104">allJobsAllStagesMetrics</a></li>
<li><a href="#L135">allJobsAllStagesMetrics</a></li>
<li><a href="#L329">boxPlotValues</a></li>
<li><a href="#L234">diffBarChartValues</a></li>
<li><a href="#L249">diffByJobTableRows</a></li>
<li><a href="#L293">diffByMetricRows</a></li>
<li><a href="#L272">diffByMetricTableRows</a></li>
<li><a href="#L348">jobName</a></li>
<li><a href="#L120">jobStageMetrics</a></li>
<li><a href="#L151">jobStageMetrics</a></li>
<li><a href="#L61">openFileInBrowser</a></li>
<li><a href="#L212">pieSectors</a></li>
<li><a href="#L73">resourceToString</a></li>
<li><a href="#L86">retrieveAppHistoryServerLink</a></li>
<li><a href="#L167">tableRows</a></li>
<li><a href="#L184">tableRows</a></li>
<li><a href="#L31">writeAndOpenHtml</a></li>
<li><a href="#L44">writeToHtml</a></li>
</ul>
 <h2>Source code</h2>

  <code>package com.microsoft.spark.insight.html<br/>
<br/>
import java.awt.Desktop<br/>
import java.io.{File, PrintWriter}<br/>
import java.net.URI<br/>
<br/>
import com.microsoft.spark.insight.utils.<a href="../utils/PerfMetric.scala.html#L17" title="com/microsoft/spark/insight/utils/PerfMetric.scala:17">PerfMetric</a>._<br/>
import com.microsoft.spark.insight.utils.spark.<a href="../utils/spark/PerfValueConversionUtils.scala.html#L13" title="com/microsoft/spark/insight/utils/spark/PerfValueConversionUtils.scala:13">PerfValueConversionUtils</a>._<br/>
import com.microsoft.spark.insight.utils.spark.<a href="../utils/spark/RawSparkApplicationAttempt.scala.html#L14" title="com/microsoft/spark/insight/utils/spark/RawSparkApplicationAttempt.scala:14">RawSparkApplicationAttempt</a>.JobId<br/>
import com.microsoft.spark.insight.utils.spark.<a href="../utils/spark/SparkAppPerfDiffReport.scala.html#L22" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfDiffReport.scala:22">SparkAppPerfDiffReport</a>.{<a href="../utils/spark/SparkAppPerfDiffReport.scala.html#L91" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfDiffReport.scala:91">MatchingPerfValues</a>, <a href="../utils/spark/SparkAppPerfDiffReport.scala.html#L83" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfDiffReport.scala:83">MatchingStageIds</a>, <a href="../utils/spark/SparkAppPerfDiffReport.scala.html#L68" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfDiffReport.scala:68">PerfMetricsDiff</a>}<br/>
import com.microsoft.spark.insight.utils.spark.<a href="../utils/spark/SparkAppPerfReport.scala.html#L26" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfReport.scala:26">SparkAppPerfReport</a>.<a href="../utils/spark/SparkAppPerfReport.scala.html#L127" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfReport.scala:127">StageIdAttemptId</a><br/>
import com.microsoft.spark.insight.utils.spark.<a href="../utils/spark/SparkAppReportMatcher.scala.html#L17" title="com/microsoft/spark/insight/utils/spark/SparkAppReportMatcher.scala:17">SparkAppReportMatcher</a>.MatchingJobIds<br/>
import com.microsoft.spark.insight.utils.spark.{<a href="../utils/spark/SparkAppPerfDiffReport.scala.html#L22" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfDiffReport.scala:22">SparkAppPerfDiffReport</a>, <a href="../utils/spark/SparkAppPerfReport.scala.html#L26" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfReport.scala:26">SparkAppPerfReport</a>}<br/>
import com.microsoft.spark.insight.utils.{<a href="../utils/AggregatePerfValue.scala.html#L6" title="com/microsoft/spark/insight/utils/AggregatePerfValue.scala:6">AggregatePerfValue</a>, <a href="../utils/PerfMetric.scala.html#L17" title="com/microsoft/spark/insight/utils/PerfMetric.scala:17">PerfMetric</a>, <a href="../utils/spark/SparkAppPerfReport.scala.html#L145" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfReport.scala:145">PerfMetrics</a>, PerfValue}<br/>
import play.twirl.api.HtmlFormat.Appendable<br/>
<br/>
import scala.io.Source<br/>
<br/>
/**<br/>
 * Utility object for writing and displaying views.html files<br/>
 */<br/>
<a id="L22">&#x200c;</a>object <span class="linkable">SparkAppHtmlUtils</span> {<br/>
<br/>
&nbsp; /**<br/>
&nbsp;&nbsp; * Writes htmlContent to a file and opens it in browser<br/>
&nbsp;&nbsp; *<br/>
&nbsp;&nbsp; * @param htmlContent is the content to be written to views.html file<br/>
&nbsp;&nbsp; * @param fileName specifies the file <a href="../fetcher/status/statusapiv1.scala.html#L48" title="com/microsoft/spark/insight/fetcher/status/statusapiv1.scala:48">name</a><br/>
&nbsp;&nbsp; * @return path to file<br/>
&nbsp;&nbsp; */<br/>
<a id="L31">&#x200c;</a>&nbsp; def <span class="linkable">writeAndOpenHtml</span>(htmlContent: Appendable, fileName: String): String = {<br/>
&nbsp; &nbsp; val file = new File(s&quot;$USER_HOME_PATH/.gridbench&quot;, s&quot;$fileName.views.html&quot;)<br/>
&nbsp; &nbsp; <a href="#L44" title="com/microsoft/spark/insight/html/SparkAppHtmlUtils.scala:44">writeToHtml</a>(htmlContent, file)<br/>
&nbsp; &nbsp; <a href="#L61" title="com/microsoft/spark/insight/html/SparkAppHtmlUtils.scala:61">openFileInBrowser</a>(file)<br/>
&nbsp; &nbsp; file.toURI.toString<br/>
&nbsp; }<br/>
<br/>
&nbsp; /**<br/>
&nbsp;&nbsp; * Writes htmlContent to file<br/>
&nbsp;&nbsp; *<br/>
&nbsp;&nbsp; * @param htmlContent is the content to be writen to views.html file<br/>
&nbsp;&nbsp; * @param file is the file to which content is to be written to<br/>
&nbsp;&nbsp; */<br/>
<a id="L44">&#x200c;</a>&nbsp; def <span class="linkable">writeToHtml</span>(htmlContent: Appendable, file: File): Unit = {<br/>
&nbsp; &nbsp; val writer = new PrintWriter(file)<br/>
&nbsp; &nbsp; try {<br/>
&nbsp; &nbsp; &nbsp; // remove redundant empty lines in htmlContent and write it to file<br/>
&nbsp; &nbsp; &nbsp; writer.write(htmlContent.body.replaceAll(&quot;&quot;&quot;(?m)^\s+$&quot;&quot;&quot;, &quot;&quot;))<br/>
&nbsp; &nbsp; } catch {<br/>
&nbsp; &nbsp; &nbsp; case exception: Exception =&gt; throw exception<br/>
&nbsp; &nbsp; } finally {<br/>
&nbsp; &nbsp; &nbsp; writer.close()<br/>
&nbsp; &nbsp; }<br/>
&nbsp; }<br/>
<br/>
&nbsp; /**<br/>
&nbsp;&nbsp; * Open a browser window to display the rendered HTML (for manual use)<br/>
&nbsp;&nbsp; *<br/>
&nbsp;&nbsp; * @param file - file to be opened in browser<br/>
&nbsp;&nbsp; */<br/>
<a id="L61">&#x200c;</a>&nbsp; def <span class="linkable">openFileInBrowser</span>(file: File): Unit = {<br/>
&nbsp; &nbsp; if (Desktop.isDesktopSupported &amp;&amp; Desktop.getDesktop.isSupported(Desktop.Action.BROWSE)) {<br/>
&nbsp; &nbsp; &nbsp; Desktop.getDesktop.browse(new URI(s&quot;file://${file.getCanonicalPath}&quot;))<br/>
&nbsp; &nbsp; }<br/>
&nbsp; }<br/>
<br/>
&nbsp; /**<br/>
&nbsp;&nbsp; * <a href="../utils/spark/SparkMetricsRowConversionUtils.scala.html#L40" title="com/microsoft/spark/insight/utils/spark/SparkMetricsRowConversionUtils.scala:40">convert</a> resource contents to string<br/>
&nbsp;&nbsp; *<br/>
&nbsp;&nbsp; * @param path - path to the file<br/>
&nbsp;&nbsp; * @return contents of file in a line separated string.<br/>
&nbsp;&nbsp; */<br/>
<a id="L73">&#x200c;</a>&nbsp; def <span class="linkable">resourceToString</span>(path: String): String = {<br/>
&nbsp; &nbsp; val stream = Source.getClass.getResourceAsStream(path)<br/>
&nbsp; &nbsp; val lines = Source.fromInputStream(stream).getLines<br/>
&nbsp; &nbsp; lines.mkString(&quot;\<a href="../utils/AggregatePerfValue.scala.html#L28" title="com/microsoft/spark/insight/utils/AggregatePerfValue.scala:28">n</a>&quot;)<br/>
&nbsp; }<br/>
<br/>
&nbsp; /**<br/>
&nbsp;&nbsp; * <a href="../cli/AppReportSets.scala.html#L44" title="com/microsoft/spark/insight/cli/AppReportSets.scala:44">retrieve</a> app history server and generate link to application's history page.<br/>
&nbsp;&nbsp; *<br/>
&nbsp;&nbsp; * @param sparkAppPerfReport an instance of [[<a href="../utils/spark/SparkAppPerfReport.scala.html#L26" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfReport.scala:26">SparkAppPerfReport</a>]]<br/>
&nbsp;&nbsp; * @return If history Server is found, returns views.html &lt;a&gt; tag containing link to history Server page of application<br/>
&nbsp;&nbsp; *&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else, application <a href="../fetcher/status/statusapiv1.scala.html#L47" title="com/microsoft/spark/insight/fetcher/status/statusapiv1.scala:47">id</a>.<br/>
&nbsp;&nbsp; */<br/>
<a id="L86">&#x200c;</a>&nbsp; def <span class="linkable">retrieveAppHistoryServerLink</span>(sparkAppPerfReport: <a href="../utils/spark/SparkAppPerfReport.scala.html#L26" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfReport.scala:26">SparkAppPerfReport</a>): String = {<br/>
&nbsp; &nbsp; val historyServer = sparkAppPerfReport.rawSparkMetrics.<a href="../utils/spark/RawSparkMetrics.scala.html#L21" title="com/microsoft/spark/insight/utils/spark/RawSparkMetrics.scala:21">firstAppAttempt</a>.appEnvInfo.sparkProperties<br/>
&nbsp; &nbsp; &nbsp; .find(_._1.equals(&quot;spark.yarn.historyServer.<a href="../fetcher/status/statusapiv1.scala.html#L136" title="com/microsoft/spark/insight/fetcher/status/statusapiv1.scala:136">address</a>&quot;))<br/>
&nbsp; &nbsp; &nbsp; .map(_._2)<br/>
&nbsp; &nbsp; val <a href="../utils/spark/RawSparkMetrics.scala.html#L31" title="com/microsoft/spark/insight/utils/spark/RawSparkMetrics.scala:31">appId</a> = sparkAppPerfReport.rawSparkMetrics.<a href="../utils/spark/RawSparkMetrics.scala.html#L31" title="com/microsoft/spark/insight/utils/spark/RawSparkMetrics.scala:31">appId</a><br/>
&nbsp; &nbsp; historyServer match {<br/>
&nbsp; &nbsp; &nbsp; case Some(server: String) =&gt;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; s&quot;&quot;&quot;&lt;a href= &quot;http://$server/history/$<a href="../utils/spark/RawSparkMetrics.scala.html#L31" title="com/microsoft/spark/insight/utils/spark/RawSparkMetrics.scala:31">appId</a>/1/jobs}&quot; target=&quot;_blank&quot;&gt; $<a href="../utils/spark/RawSparkMetrics.scala.html#L31" title="com/microsoft/spark/insight/utils/spark/RawSparkMetrics.scala:31">appId</a>&lt;/a&gt;&quot;&quot;&quot;<br/>
&nbsp; &nbsp; &nbsp; case _ =&gt; <a href="../utils/spark/RawSparkMetrics.scala.html#L31" title="com/microsoft/spark/insight/utils/spark/RawSparkMetrics.scala:31">appId</a><br/>
&nbsp; &nbsp; }<br/>
&nbsp; }<br/>
<br/>
&nbsp; /**<br/>
&nbsp;&nbsp; * Return a seq of All Jobs All Stages metrics<br/>
&nbsp;&nbsp; *<br/>
&nbsp;&nbsp; * @param sparkAppPerfReport an instance of [[<a href="../utils/spark/SparkAppPerfReport.scala.html#L26" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfReport.scala:26">SparkAppPerfReport</a>]]<br/>
&nbsp;&nbsp; * @return all stages metrics<br/>
&nbsp;&nbsp; */<br/>
<a id="L104">&#x200c;</a>&nbsp; def <span class="linkable">allJobsAllStagesMetrics</span>(<br/>
&nbsp; &nbsp; &nbsp; sparkAppPerfReport: <a href="../utils/spark/SparkAppPerfReport.scala.html#L26" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfReport.scala:26">SparkAppPerfReport</a>): Seq[(<a href="../utils/spark/SparkAppPerfReport.scala.html#L127" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfReport.scala:127">StageIdAttemptId</a>, Seq[(<a href="../utils/PerfMetric.scala.html#L17" title="com/microsoft/spark/insight/utils/PerfMetric.scala:17">PerfMetric</a>, PerfValue)])] =<br/>
&nbsp; &nbsp; sparkAppPerfReport.<a href="../utils/spark/SparkAppPerfReportBase.scala.html#L56" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfReportBase.scala:56">perJobReport</a>.<a href="../utils/spark/PerJobReport.scala.html#L55" title="com/microsoft/spark/insight/utils/spark/PerJobReport.scala:55">allJobs</a><br/>
&nbsp; &nbsp; &nbsp; .map(_.toSeq)<br/>
&nbsp; &nbsp; &nbsp; .toSeq<br/>
&nbsp; &nbsp; &nbsp; .reduce(_ ++ _)<br/>
&nbsp; &nbsp; &nbsp; .map(v =&gt; (v._1, v._2.toSeq))<br/>
&nbsp; &nbsp; &nbsp; .sortBy(_._1.toString)<br/>
<br/>
&nbsp; /**<br/>
&nbsp;&nbsp; * For a given jobKey, return a seq of All Stages metrics<br/>
&nbsp;&nbsp; *<br/>
&nbsp;&nbsp; * @param sparkAppPerfReport an instance of [[<a href="../utils/spark/SparkAppPerfReport.scala.html#L26" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfReport.scala:26">SparkAppPerfReport</a>]]<br/>
&nbsp;&nbsp; * @param jobKey&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; JobId for which metricsList is to be retrieved.<br/>
&nbsp;&nbsp; * @return <a href="../utils/spark/PerJobReport.scala.html#L48" title="com/microsoft/spark/insight/utils/spark/PerJobReport.scala:48">job</a>'s <a href="../utils/spark/PerStageReport.scala.html#L26" title="com/microsoft/spark/insight/utils/spark/PerStageReport.scala:26">stage</a> metrics<br/>
&nbsp;&nbsp; */<br/>
<a id="L120">&#x200c;</a>&nbsp; def <span class="linkable">jobStageMetrics</span>(<br/>
&nbsp; &nbsp; &nbsp; sparkAppPerfReport: <a href="../utils/spark/SparkAppPerfReport.scala.html#L26" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfReport.scala:26">SparkAppPerfReport</a>,<br/>
&nbsp; &nbsp; &nbsp; jobKey: JobId): Seq[(<a href="../utils/spark/SparkAppPerfReport.scala.html#L127" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfReport.scala:127">StageIdAttemptId</a>, Seq[(<a href="../utils/PerfMetric.scala.html#L17" title="com/microsoft/spark/insight/utils/PerfMetric.scala:17">PerfMetric</a>, PerfValue)])] =<br/>
&nbsp; &nbsp; sparkAppPerfReport.<a href="../utils/spark/SparkAppPerfReportBase.scala.html#L56" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfReportBase.scala:56">perJobReport</a><br/>
&nbsp; &nbsp; &nbsp; .<a href="../utils/spark/PerJobReport.scala.html#L48" title="com/microsoft/spark/insight/utils/spark/PerJobReport.scala:48">job</a>(jobKey)<br/>
&nbsp; &nbsp; &nbsp; .toSeq<br/>
&nbsp; &nbsp; &nbsp; .map(v =&gt; (v._1, v._2.toSeq))<br/>
&nbsp; &nbsp; &nbsp; .sortBy(_._1.toString)<br/>
<br/>
&nbsp; /**<br/>
&nbsp;&nbsp; * Return a sequence of All Jobs All Stage Metrics<br/>
&nbsp;&nbsp; *<br/>
&nbsp;&nbsp; * @param sparkAppPerfDiffReport an instance of [[<a href="../utils/spark/SparkAppPerfDiffReport.scala.html#L22" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfDiffReport.scala:22">SparkAppPerfDiffReport</a>]]<br/>
&nbsp;&nbsp; * @return all <a href="../utils/spark/PerStageReport.scala.html#L26" title="com/microsoft/spark/insight/utils/spark/PerStageReport.scala:26">stage</a> metrics<br/>
&nbsp;&nbsp; */<br/>
<a id="L135">&#x200c;</a>&nbsp; def <span class="linkable">allJobsAllStagesMetrics</span>(<br/>
&nbsp; &nbsp; &nbsp; sparkAppPerfDiffReport: <a href="../utils/spark/SparkAppPerfDiffReport.scala.html#L22" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfDiffReport.scala:22">SparkAppPerfDiffReport</a>): Seq[(<a href="../utils/spark/SparkAppPerfDiffReport.scala.html#L83" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfDiffReport.scala:83">MatchingStageIds</a>, Seq[(<a href="../utils/PerfMetric.scala.html#L17" title="com/microsoft/spark/insight/utils/PerfMetric.scala:17">PerfMetric</a>, <a href="../utils/spark/SparkAppPerfDiffReport.scala.html#L91" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfDiffReport.scala:91">MatchingPerfValues</a>)])] =<br/>
&nbsp; &nbsp; sparkAppPerfDiffReport.<a href="../utils/spark/SparkAppPerfReportBase.scala.html#L56" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfReportBase.scala:56">perJobReport</a>.<a href="../utils/spark/PerJobReport.scala.html#L55" title="com/microsoft/spark/insight/utils/spark/PerJobReport.scala:55">allJobs</a><br/>
&nbsp; &nbsp; &nbsp; .map(_.toSeq)<br/>
&nbsp; &nbsp; &nbsp; .toSeq<br/>
&nbsp; &nbsp; &nbsp; .reduce(_ ++ _)<br/>
&nbsp; &nbsp; &nbsp; .map(v =&gt; (v._1, v._2.toSeq))<br/>
&nbsp; &nbsp; &nbsp; .sortBy(_._1.toString)<br/>
<br/>
&nbsp; /**<br/>
&nbsp;&nbsp; * For a given jobKey, return a seq of All Stages metrics<br/>
&nbsp;&nbsp; *<br/>
&nbsp;&nbsp; * @param sparkAppPerfDiffReport an instance of [[<a href="../utils/spark/SparkAppPerfDiffReport.scala.html#L22" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfDiffReport.scala:22">SparkAppPerfDiffReport</a>]]<br/>
&nbsp;&nbsp; * @param jobKey Matching Job Id for which metricsList is to be retrieved.<br/>
&nbsp;&nbsp; * @return matching Job's <a href="../utils/spark/PerStageReport.scala.html#L26" title="com/microsoft/spark/insight/utils/spark/PerStageReport.scala:26">stage</a> metrics<br/>
&nbsp;&nbsp; */<br/>
<a id="L151">&#x200c;</a>&nbsp; def <span class="linkable">jobStageMetrics</span>(<br/>
&nbsp; &nbsp; &nbsp; sparkAppPerfDiffReport: <a href="../utils/spark/SparkAppPerfDiffReport.scala.html#L22" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfDiffReport.scala:22">SparkAppPerfDiffReport</a>,<br/>
&nbsp; &nbsp; &nbsp; jobKey: MatchingJobIds): Seq[(<a href="../utils/spark/SparkAppPerfDiffReport.scala.html#L83" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfDiffReport.scala:83">MatchingStageIds</a>, Seq[(<a href="../utils/PerfMetric.scala.html#L17" title="com/microsoft/spark/insight/utils/PerfMetric.scala:17">PerfMetric</a>, <a href="../utils/spark/SparkAppPerfDiffReport.scala.html#L91" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfDiffReport.scala:91">MatchingPerfValues</a>)])] =<br/>
&nbsp; &nbsp; sparkAppPerfDiffReport.<a href="../utils/spark/SparkAppPerfReportBase.scala.html#L56" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfReportBase.scala:56">perJobReport</a><br/>
&nbsp; &nbsp; &nbsp; .<a href="../utils/spark/PerJobReport.scala.html#L48" title="com/microsoft/spark/insight/utils/spark/PerJobReport.scala:48">job</a>(jobKey)<br/>
&nbsp; &nbsp; &nbsp; .toSeq<br/>
&nbsp; &nbsp; &nbsp; .map(v =&gt; (v._1, v._2.toSeq))<br/>
&nbsp; &nbsp; &nbsp; .sortBy(_._1.toString)<br/>
<br/>
&nbsp; /**<br/>
&nbsp;&nbsp; * for a given metrics list, return a sequence of <a href="../heuristics/HeuristicResult.scala.html#L25" title="com/microsoft/spark/insight/heuristics/HeuristicResult.scala:25">rows</a> to be displayed in the table<br/>
&nbsp;&nbsp; *<br/>
&nbsp;&nbsp; * @param perfMetrics corresponding perfmetrics<br/>
&nbsp;&nbsp; * @return a sequence table <a href="../heuristics/HeuristicResult.scala.html#L25" title="com/microsoft/spark/insight/heuristics/HeuristicResult.scala:25">rows</a>.<br/>
&nbsp;&nbsp; *&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; Each row is a sequence of entries<br/>
&nbsp;&nbsp; */<br/>
<a id="L167">&#x200c;</a>&nbsp; def <span class="linkable">tableRows</span>(perfMetrics: <a href="../utils/spark/SparkAppPerfReport.scala.html#L145" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfReport.scala:145">PerfMetrics</a>[PerfValue]): Seq[Seq[String]] = {<br/>
&nbsp; &nbsp; val body = perfMetrics.toSeq.sortBy(_._1.displayName).map {<br/>
&nbsp; &nbsp; &nbsp; case (perfMetric, <a href="../fetcher/status/statusapiv1.scala.html#L305" title="com/microsoft/spark/insight/fetcher/status/statusapiv1.scala:305">value</a>) =&gt;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; val (units, transformer) = <a href="../utils/spark/PerfValueConversionUtils.scala.html#L21" title="com/microsoft/spark/insight/utils/spark/PerfValueConversionUtils.scala:21">getUnitsAndTransformer</a>(perfMetric, PERF_VALUE_PRECISION_HTML)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; Seq(perfMetric.displayName, transformer(<a href="../fetcher/status/statusapiv1.scala.html#L305" title="com/microsoft/spark/insight/fetcher/status/statusapiv1.scala:305">value</a>), s&quot;${perfMetric.<a href="../fetcher/status/statusapiv1.scala.html#L106" title="com/microsoft/spark/insight/fetcher/status/statusapiv1.scala:106">description</a>} (in $units)&quot;)<br/>
&nbsp; &nbsp; }<br/>
&nbsp; &nbsp; Seq(&quot;Metric Name&quot;, &quot;Metric Value&quot;, &quot;Metric Description&quot;) +: body<br/>
&nbsp; }<br/>
<br/>
&nbsp; /**<br/>
&nbsp;&nbsp; * generate <a href="../heuristics/HeuristicResult.scala.html#L25" title="com/microsoft/spark/insight/heuristics/HeuristicResult.scala:25">rows</a> for tables in by-metric-tab<br/>
&nbsp;&nbsp; *<br/>
&nbsp;&nbsp; * @param stageMetrics seq of <a href="../utils/spark/PerStageReport.scala.html#L26" title="com/microsoft/spark/insight/utils/spark/PerStageReport.scala:26">stage</a> <a href="../fetcher/status/statusapiv1.scala.html#L47" title="com/microsoft/spark/insight/fetcher/status/statusapiv1.scala:47">id</a> and corresponding perfValue<br/>
&nbsp;&nbsp; * @param metric corresponding metric<br/>
&nbsp;&nbsp; * @return sequence of table <a href="../heuristics/HeuristicResult.scala.html#L25" title="com/microsoft/spark/insight/heuristics/HeuristicResult.scala:25">rows</a>.<br/>
&nbsp;&nbsp; *&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; Each row is a sequence of table entries<br/>
&nbsp;&nbsp; */<br/>
<a id="L184">&#x200c;</a>&nbsp; def <span class="linkable">tableRows</span>(stageMetrics: Seq[(<a href="../utils/spark/SparkAppPerfReport.scala.html#L127" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfReport.scala:127">StageIdAttemptId</a>, PerfValue)], metric: <a href="../utils/PerfMetric.scala.html#L17" title="com/microsoft/spark/insight/utils/PerfMetric.scala:17">PerfMetric</a>): Seq[Seq[String]] = {<br/>
&nbsp; &nbsp; val (units, transformer) = <a href="../utils/spark/PerfValueConversionUtils.scala.html#L21" title="com/microsoft/spark/insight/utils/spark/PerfValueConversionUtils.scala:21">getUnitsAndTransformer</a>(metric, PERF_VALUE_PRECISION_HTML)<br/>
&nbsp; &nbsp; val metricSum: Double = stageMetrics.map(_._2).sum.toDouble<br/>
<br/>
&nbsp; &nbsp; var body = stageMetrics.take(NO_OF_TABLE_ROWS_HTML).map {<br/>
&nbsp; &nbsp; &nbsp; case (<a href="../fetcher/status/statusapiv1.scala.html#L150" title="com/microsoft/spark/insight/fetcher/status/statusapiv1.scala:150">stageId</a>, <a href="../fetcher/status/statusapiv1.scala.html#L305" title="com/microsoft/spark/insight/fetcher/status/statusapiv1.scala:305">value</a>) =&gt;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; val percentage = if (metricSum &gt; 0) <a href="../utils/spark/PerfValueConversionUtils.scala.html#L61" title="com/microsoft/spark/insight/utils/spark/PerfValueConversionUtils.scala:61">roundUpDouble</a>(<a href="../fetcher/status/statusapiv1.scala.html#L305" title="com/microsoft/spark/insight/fetcher/status/statusapiv1.scala:305">value</a> / metricSum * 100, PERF_VALUE_PRECISION_HTML) else &quot;0&quot;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; Seq(<a href="../fetcher/status/statusapiv1.scala.html#L150" title="com/microsoft/spark/insight/fetcher/status/statusapiv1.scala:150">stageId</a>.toString, transformer(<a href="../fetcher/status/statusapiv1.scala.html#L305" title="com/microsoft/spark/insight/fetcher/status/statusapiv1.scala:305">value</a>), percentage)<br/>
&nbsp; &nbsp; }<br/>
<br/>
&nbsp; &nbsp; if (stageMetrics.length &gt; NO_OF_TABLE_ROWS_HTML) {<br/>
&nbsp; &nbsp; &nbsp; val othersSum = metricSum - stageMetrics.take(NO_OF_TABLE_ROWS_HTML).map(_._2).sum<br/>
&nbsp; &nbsp; &nbsp; val othersPercentage =<br/>
&nbsp; &nbsp; &nbsp; &nbsp; if (metricSum &gt; 0) <a href="../utils/spark/PerfValueConversionUtils.scala.html#L61" title="com/microsoft/spark/insight/utils/spark/PerfValueConversionUtils.scala:61">roundUpDouble</a>(othersSum / metricSum * 100, PERF_VALUE_PRECISION_HTML) else &quot;0&quot;<br/>
&nbsp; &nbsp; &nbsp; body = body :+ Seq(&quot;Others&quot;, transformer(othersSum), othersPercentage)<br/>
&nbsp; &nbsp; }<br/>
<br/>
&nbsp; &nbsp; Seq(&quot;Stage Id&quot;, s&quot;Metric Value (in $units)&quot;, &quot;Percentage&quot;) +: body :+<br/>
&nbsp; &nbsp; &nbsp; Seq(&quot;TOTAL&quot;, transformer(metricSum), if (metricSum &gt; 0) &quot;100.000&quot; else &quot;0.000&quot;)<br/>
&nbsp; }<br/>
<br/>
&nbsp; /**<br/>
&nbsp;&nbsp; * generate pie chart data.<br/>
&nbsp;&nbsp; *<br/>
&nbsp;&nbsp; * @param stageMetrics seq of <a href="../utils/spark/PerStageReport.scala.html#L26" title="com/microsoft/spark/insight/utils/spark/PerStageReport.scala:26">stage</a> <a href="../fetcher/status/statusapiv1.scala.html#L47" title="com/microsoft/spark/insight/fetcher/status/statusapiv1.scala:47">id</a> and corresponding perfValue<br/>
&nbsp;&nbsp; * @param metric corresponding metric<br/>
&nbsp;&nbsp; * @return Sequence of Strings corresponding to pie sectors.<br/>
&nbsp;&nbsp; */<br/>
<a id="L212">&#x200c;</a>&nbsp; def <span class="linkable">pieSectors</span>(stageMetrics: Seq[(<a href="../utils/spark/SparkAppPerfReport.scala.html#L127" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfReport.scala:127">StageIdAttemptId</a>, PerfValue)], metric: <a href="../utils/PerfMetric.scala.html#L17" title="com/microsoft/spark/insight/utils/PerfMetric.scala:17">PerfMetric</a>): Seq[(String, String)] = {<br/>
&nbsp; &nbsp; val transformer = <a href="../utils/spark/PerfValueConversionUtils.scala.html#L21" title="com/microsoft/spark/insight/utils/spark/PerfValueConversionUtils.scala:21">getUnitsAndTransformer</a>(metric, PERF_VALUE_PRECISION_HTML)._2<br/>
<br/>
&nbsp; &nbsp; var sectors = stageMetrics.take(NO_OF_PIE_SECTORS).map {<br/>
&nbsp; &nbsp; &nbsp; case (<a href="../fetcher/status/statusapiv1.scala.html#L150" title="com/microsoft/spark/insight/fetcher/status/statusapiv1.scala:150">stageId</a>, <a href="../fetcher/status/statusapiv1.scala.html#L305" title="com/microsoft/spark/insight/fetcher/status/statusapiv1.scala:305">value</a>) =&gt;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; (<a href="../fetcher/status/statusapiv1.scala.html#L150" title="com/microsoft/spark/insight/fetcher/status/statusapiv1.scala:150">stageId</a>.toString(), transformer(<a href="../fetcher/status/statusapiv1.scala.html#L305" title="com/microsoft/spark/insight/fetcher/status/statusapiv1.scala:305">value</a>))<br/>
&nbsp; &nbsp; }<br/>
<br/>
&nbsp; &nbsp; if (stageMetrics.length &gt; NO_OF_PIE_SECTORS) {<br/>
&nbsp; &nbsp; &nbsp; val othersSum: Double = stageMetrics.map(_._2).sum - stageMetrics.take(NO_OF_PIE_SECTORS).map(_._2).sum<br/>
&nbsp; &nbsp; &nbsp; sectors = sectors :+ Tuple2(&quot;Others&quot;, transformer(othersSum))<br/>
&nbsp; &nbsp; }<br/>
&nbsp; &nbsp; sectors<br/>
&nbsp; }<br/>
<br/>
&nbsp; /**<br/>
&nbsp;&nbsp; * generates bar chart values in by metric tab in views.html version of diff report.<br/>
&nbsp;&nbsp; *<br/>
&nbsp;&nbsp; * @param stageMetrics seq of matching <a href="../utils/spark/PerStageReport.scala.html#L26" title="com/microsoft/spark/insight/utils/spark/PerStageReport.scala:26">stage</a> ids and corresponding perfValues.<br/>
&nbsp;&nbsp; * @param metric corresponding metric<br/>
&nbsp;&nbsp; * @return Sequence of tuple corresponding to bar chart entries.<br/>
&nbsp;&nbsp; */<br/>
<a id="L234">&#x200c;</a>&nbsp; def <span class="linkable">diffBarChartValues</span>(<br/>
&nbsp; &nbsp; &nbsp; stageMetrics: Seq[(<a href="../utils/spark/SparkAppPerfDiffReport.scala.html#L83" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfDiffReport.scala:83">MatchingStageIds</a>, <a href="../utils/spark/SparkAppPerfDiffReport.scala.html#L91" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfDiffReport.scala:91">MatchingPerfValues</a>)],<br/>
&nbsp; &nbsp; &nbsp; metric: <a href="../utils/PerfMetric.scala.html#L17" title="com/microsoft/spark/insight/utils/PerfMetric.scala:17">PerfMetric</a>): Seq[(String, String, String, String)] = {<br/>
&nbsp; &nbsp; val transformer = <a href="../utils/spark/PerfValueConversionUtils.scala.html#L21" title="com/microsoft/spark/insight/utils/spark/PerfValueConversionUtils.scala:21">getUnitsAndTransformer</a>(metric, PERF_VALUE_PRECISION_HTML)._2<br/>
&nbsp; &nbsp; val sectors = <a href="#L293" title="com/microsoft/spark/insight/html/SparkAppHtmlUtils.scala:293">diffByMetricRows</a>(stageMetrics, NO_OF_PIE_SECTORS, transformer)<br/>
&nbsp; &nbsp; sectors.take(sectors.length - 1)<br/>
&nbsp; }<br/>
<br/>
&nbsp; /**<br/>
&nbsp;&nbsp; * generate Table <a href="../heuristics/HeuristicResult.scala.html#L25" title="com/microsoft/spark/insight/heuristics/HeuristicResult.scala:25">rows</a> for by <a href="../utils/spark/PerJobReport.scala.html#L48" title="com/microsoft/spark/insight/utils/spark/PerJobReport.scala:48">job</a> tab in views.html version of diff report.<br/>
&nbsp;&nbsp; *<br/>
&nbsp;&nbsp; * Uses the sequence of tuples generated by [[<a href="#L293" title="com/microsoft/spark/insight/html/SparkAppHtmlUtils.scala:293">diffByMetricRows</a>()]]<br/>
&nbsp;&nbsp; * @param perfMetricsDiff an instance of [[<a href="../utils/spark/SparkAppPerfDiffReport.scala.html#L68" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfDiffReport.scala:68">PerfMetricsDiff</a>]]<br/>
&nbsp;&nbsp; * @return sequence of table <a href="../heuristics/HeuristicResult.scala.html#L25" title="com/microsoft/spark/insight/heuristics/HeuristicResult.scala:25">rows</a>.<br/>
&nbsp;&nbsp; */<br/>
<a id="L249">&#x200c;</a>&nbsp; def <span class="linkable">diffByJobTableRows</span>(perfMetricsDiff: <a href="../utils/spark/SparkAppPerfDiffReport.scala.html#L68" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfDiffReport.scala:68">PerfMetricsDiff</a>): Seq[Seq[String]] = {<br/>
&nbsp; &nbsp; val body: Seq[Seq[String]] =<br/>
&nbsp; &nbsp; &nbsp; perfMetricsDiff.toSeq.sortBy(_._1.displayName).map {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; case (perfMetric, matchingPerfValues) =&gt;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; val (units, transformer) = <a href="../utils/spark/PerfValueConversionUtils.scala.html#L21" title="com/microsoft/spark/insight/utils/spark/PerfValueConversionUtils.scala:21">getUnitsAndTransformer</a>(perfMetric, PERF_VALUE_PRECISION_HTML)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Seq(<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; perfMetric.displayName,<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; transformer(matchingPerfValues.perfValue1),<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; transformer(matchingPerfValues.perfValue2),<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; transformer(matchingPerfValues.perfValue2 - matchingPerfValues.perfValue1),<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; s&quot;${perfMetric.<a href="../fetcher/status/statusapiv1.scala.html#L106" title="com/microsoft/spark/insight/fetcher/status/statusapiv1.scala:106">description</a>} (in $units)&quot;)<br/>
&nbsp; &nbsp; &nbsp; }<br/>
&nbsp; &nbsp; Seq(&quot;Metric Name&quot;, &quot;App #1 Metric Value&quot;, &quot;App #2 Metric Value&quot;, &quot;Diff&quot;, &quot;Description&quot;) +: body<br/>
&nbsp; }<br/>
<br/>
&nbsp; /**<br/>
&nbsp;&nbsp; * generate Table <a href="../heuristics/HeuristicResult.scala.html#L25" title="com/microsoft/spark/insight/heuristics/HeuristicResult.scala:25">rows</a> for by metric tab in views.html version of diff report.<br/>
&nbsp;&nbsp; *<br/>
&nbsp;&nbsp; * Uses the sequence of tuples generated by [[<a href="#L293" title="com/microsoft/spark/insight/html/SparkAppHtmlUtils.scala:293">diffByMetricRows</a>()]]<br/>
&nbsp;&nbsp; * @param stageMetrics seq of matching <a href="../utils/spark/PerStageReport.scala.html#L26" title="com/microsoft/spark/insight/utils/spark/PerStageReport.scala:26">stage</a> ids and corresponding perfValues.<br/>
&nbsp;&nbsp; * @param metric corresponding metric<br/>
&nbsp;&nbsp; * @return Sequence of table <a href="../heuristics/HeuristicResult.scala.html#L25" title="com/microsoft/spark/insight/heuristics/HeuristicResult.scala:25">rows</a>.<br/>
&nbsp;&nbsp; */<br/>
<a id="L272">&#x200c;</a>&nbsp; def <span class="linkable">diffByMetricTableRows</span>(<br/>
&nbsp; &nbsp; &nbsp; stageMetrics: Seq[(<a href="../utils/spark/SparkAppPerfDiffReport.scala.html#L83" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfDiffReport.scala:83">MatchingStageIds</a>, <a href="../utils/spark/SparkAppPerfDiffReport.scala.html#L91" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfDiffReport.scala:91">MatchingPerfValues</a>)],<br/>
&nbsp; &nbsp; &nbsp; metric: <a href="../utils/PerfMetric.scala.html#L17" title="com/microsoft/spark/insight/utils/PerfMetric.scala:17">PerfMetric</a>): Seq[Seq[String]] = {<br/>
&nbsp; &nbsp; val (units, transformer) = <a href="../utils/spark/PerfValueConversionUtils.scala.html#L21" title="com/microsoft/spark/insight/utils/spark/PerfValueConversionUtils.scala:21">getUnitsAndTransformer</a>(metric, PERF_VALUE_PRECISION_HTML)<br/>
&nbsp; &nbsp; val <a href="../heuristics/HeuristicResult.scala.html#L25" title="com/microsoft/spark/insight/heuristics/HeuristicResult.scala:25">rows</a> = <a href="#L293" title="com/microsoft/spark/insight/html/SparkAppHtmlUtils.scala:293">diffByMetricRows</a>(stageMetrics, NO_OF_TABLE_ROWS_HTML, transformer)<br/>
&nbsp; &nbsp; val body = <a href="../heuristics/HeuristicResult.scala.html#L25" title="com/microsoft/spark/insight/heuristics/HeuristicResult.scala:25">rows</a>.map {<br/>
&nbsp; &nbsp; &nbsp; case (<a href="../fetcher/status/statusapiv1.scala.html#L150" title="com/microsoft/spark/insight/fetcher/status/statusapiv1.scala:150">stageId</a>, perfValue1, perfValue2, diff) =&gt;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; Seq(<a href="../fetcher/status/statusapiv1.scala.html#L150" title="com/microsoft/spark/insight/fetcher/status/statusapiv1.scala:150">stageId</a>, perfValue1, perfValue2, diff)<br/>
&nbsp; &nbsp; }<br/>
<br/>
&nbsp; &nbsp; Seq(&quot;Stage Id&quot;, s&quot;App #1 Metric Value (in $units)&quot;, s&quot;App #2 Metric Value (in $units)&quot;, s&quot;Diff (in $units)&quot;) +: body<br/>
&nbsp; }<br/>
<br/>
&nbsp; /**<br/>
&nbsp;&nbsp; * generate a sequence of tuples containing <a href="../utils/spark/PerStageReport.scala.html#L26" title="com/microsoft/spark/insight/utils/spark/PerStageReport.scala:26">stage</a> data for given <a href="../utils/spark/PerStageReport.scala.html#L26" title="com/microsoft/spark/insight/utils/spark/PerStageReport.scala:26">stage</a> metrics<br/>
&nbsp;&nbsp; *<br/>
&nbsp;&nbsp; * @param stageMetrics seq of matching <a href="../utils/spark/PerStageReport.scala.html#L26" title="com/microsoft/spark/insight/utils/spark/PerStageReport.scala:26">stage</a> ids and corresponding perfValues.<br/>
&nbsp;&nbsp; * @param noOfEntries number of entries that should be returned.<br/>
&nbsp;&nbsp; * @param transformer corresponding transformer for the metric.<br/>
&nbsp;&nbsp; * @return a sequence of tuples<br/>
&nbsp;&nbsp; */<br/>
<a id="L293">&#x200c;</a>&nbsp; def <span class="linkable">diffByMetricRows</span>(<br/>
&nbsp; &nbsp; &nbsp; stageMetrics: Seq[(<a href="../utils/spark/SparkAppPerfDiffReport.scala.html#L83" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfDiffReport.scala:83">MatchingStageIds</a>, <a href="../utils/spark/SparkAppPerfDiffReport.scala.html#L91" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfDiffReport.scala:91">MatchingPerfValues</a>)],<br/>
&nbsp; &nbsp; &nbsp; noOfEntries: Int,<br/>
&nbsp; &nbsp; &nbsp; transformer: Double =&gt; String): Seq[(String, String, String, String)] = {<br/>
&nbsp; &nbsp; val values = (stageMetrics.map(<a href="../utils/spark/PerStageReport.scala.html#L26" title="com/microsoft/spark/insight/utils/spark/PerStageReport.scala:26">stage</a> =&gt; <a href="../utils/spark/PerStageReport.scala.html#L26" title="com/microsoft/spark/insight/utils/spark/PerStageReport.scala:26">stage</a>._2.perfValue2 - <a href="../utils/spark/PerStageReport.scala.html#L26" title="com/microsoft/spark/insight/utils/spark/PerStageReport.scala:26">stage</a>._2.perfValue1) zip stageMetrics).sortBy(_._1)<br/>
<br/>
&nbsp; &nbsp; var entries = values.take(noOfEntries).map {<br/>
&nbsp; &nbsp; &nbsp; case (diff, (<a href="../fetcher/status/statusapiv1.scala.html#L150" title="com/microsoft/spark/insight/fetcher/status/statusapiv1.scala:150">stageId</a>, matchingPerfValue)) =&gt;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; (<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="../fetcher/status/statusapiv1.scala.html#L150" title="com/microsoft/spark/insight/fetcher/status/statusapiv1.scala:150">stageId</a>.toString,<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; transformer(matchingPerfValue.perfValue1),<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; transformer(matchingPerfValue.perfValue2),<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; transformer(diff))<br/>
&nbsp; &nbsp; }<br/>
<br/>
&nbsp; &nbsp; if (values.length &gt; noOfEntries) {<br/>
&nbsp; &nbsp; &nbsp; val othersSum1 = values.map(_._2._2.perfValue1).sum - values.take(noOfEntries).map(_._2._2.perfValue1).sum<br/>
&nbsp; &nbsp; &nbsp; val othersSum2 = values.map(_._2._2.perfValue2).sum - values.take(noOfEntries).map(_._2._2.perfValue2).sum<br/>
&nbsp; &nbsp; &nbsp; val diffOthersSum = values.map(_._1).sum - values.take(noOfEntries).map(_._1).sum<br/>
&nbsp; &nbsp; &nbsp; entries =<br/>
&nbsp; &nbsp; &nbsp; &nbsp; entries :+ Tuple4(&quot;Others&quot;, transformer(othersSum1), transformer(othersSum2), transformer(diffOthersSum))<br/>
&nbsp; &nbsp; }<br/>
&nbsp; &nbsp; entries :+ Tuple4(<br/>
&nbsp; &nbsp; &nbsp; &quot;TOTAL&quot;,<br/>
&nbsp; &nbsp; &nbsp; transformer(values.map(_._2._2.perfValue1).sum),<br/>
&nbsp; &nbsp; &nbsp; transformer(values.map(_._2._2.perfValue2).sum),<br/>
&nbsp; &nbsp; &nbsp; transformer(values.map(_._1).sum))<br/>
&nbsp; }<br/>
<br/>
&nbsp; /**<br/>
&nbsp;&nbsp; * For a given aggregatePerfValue, generates the entries required in the Box chart<br/>
&nbsp;&nbsp; *<br/>
&nbsp;&nbsp; * @param aggregatePerfValue : an instance of [[<a href="../utils/AggregatePerfValue.scala.html#L6" title="com/microsoft/spark/insight/utils/AggregatePerfValue.scala:6">AggregatePerfValue</a>]]<br/>
&nbsp;&nbsp; * @param metric : corresponding metric<br/>
&nbsp;&nbsp; * @return a sequence of String<br/>
&nbsp;&nbsp; */<br/>
<a id="L329">&#x200c;</a>&nbsp; def <span class="linkable">boxPlotValues</span>(aggregatePerfValue: <a href="../utils/AggregatePerfValue.scala.html#L6" title="com/microsoft/spark/insight/utils/AggregatePerfValue.scala:6">AggregatePerfValue</a>, metric: <a href="../utils/PerfMetric.scala.html#L17" title="com/microsoft/spark/insight/utils/PerfMetric.scala:17">PerfMetric</a>): Seq[String] = {<br/>
&nbsp; &nbsp; val transformer = <a href="../utils/spark/PerfValueConversionUtils.scala.html#L21" title="com/microsoft/spark/insight/utils/spark/PerfValueConversionUtils.scala:21">getUnitsAndTransformer</a>(metric, 4)._2<br/>
&nbsp; &nbsp; Seq(<br/>
&nbsp; &nbsp; &nbsp; transformer(aggregatePerfValue.<a href="../utils/AggregatePerfValue.scala.html#L14" title="com/microsoft/spark/insight/utils/AggregatePerfValue.scala:14">percentile</a>(25)),<br/>
&nbsp; &nbsp; &nbsp; transformer(aggregatePerfValue.<a href="../utils/AggregatePerfValue.scala.html#L14" title="com/microsoft/spark/insight/utils/AggregatePerfValue.scala:14">percentile</a>(50)),<br/>
&nbsp; &nbsp; &nbsp; transformer(aggregatePerfValue.<a href="../utils/AggregatePerfValue.scala.html#L14" title="com/microsoft/spark/insight/utils/AggregatePerfValue.scala:14">percentile</a>(75)),<br/>
&nbsp; &nbsp; &nbsp; transformer(aggregatePerfValue.<a href="../utils/AggregatePerfValue.scala.html#L24" title="com/microsoft/spark/insight/utils/AggregatePerfValue.scala:24">min</a>),<br/>
&nbsp; &nbsp; &nbsp; transformer(aggregatePerfValue.<a href="../utils/AggregatePerfValue.scala.html#L26" title="com/microsoft/spark/insight/utils/AggregatePerfValue.scala:26">max</a>),<br/>
&nbsp; &nbsp; &nbsp; transformer(aggregatePerfValue.<a href="../utils/AggregatePerfValue.scala.html#L18" title="com/microsoft/spark/insight/utils/AggregatePerfValue.scala:18">mean</a>),<br/>
&nbsp; &nbsp; &nbsp; transformer(aggregatePerfValue.<a href="../utils/AggregatePerfValue.scala.html#L22" title="com/microsoft/spark/insight/utils/AggregatePerfValue.scala:22">stddev</a>))<br/>
&nbsp; }<br/>
<br/>
&nbsp; /**<br/>
&nbsp;&nbsp; * For a given Job key and <a href="../utils/spark/SparkAppPerfReport.scala.html#L26" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfReport.scala:26">SparkAppPerfReport</a>, return the <a href="../utils/spark/PerJobReport.scala.html#L48" title="com/microsoft/spark/insight/utils/spark/PerJobReport.scala:48">job</a> <a href="../fetcher/status/statusapiv1.scala.html#L48" title="com/microsoft/spark/insight/fetcher/status/statusapiv1.scala:48">name</a><br/>
&nbsp;&nbsp; *<br/>
&nbsp;&nbsp; * @param jobKey JobId of the Job<br/>
&nbsp;&nbsp; * @param sparkAppPerfReport an instance of [[<a href="../utils/spark/SparkAppPerfReport.scala.html#L26" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfReport.scala:26">SparkAppPerfReport</a>]]<br/>
&nbsp;&nbsp; * @return Job <a href="../fetcher/status/statusapiv1.scala.html#L48" title="com/microsoft/spark/insight/fetcher/status/statusapiv1.scala:48">name</a> of the corresponding <a href="../utils/spark/PerJobReport.scala.html#L48" title="com/microsoft/spark/insight/utils/spark/PerJobReport.scala:48">job</a><br/>
&nbsp;&nbsp; */<br/>
<a id="L348">&#x200c;</a>&nbsp; def <span class="linkable">jobName</span>(jobKey: JobId, sparkAppPerfReport: <a href="../utils/spark/SparkAppPerfReport.scala.html#L26" title="com/microsoft/spark/insight/utils/spark/SparkAppPerfReport.scala:26">SparkAppPerfReport</a>): String =<br/>
&nbsp; &nbsp; sparkAppPerfReport.rawSparkMetrics.appAttemptMap.values.toSeq.head.jobDataMap(jobKey).<a href="../fetcher/status/statusapiv1.scala.html#L48" title="com/microsoft/spark/insight/fetcher/status/statusapiv1.scala:48">name</a><br/>
<br/>
&nbsp; /**<br/>
&nbsp;&nbsp; * <a href="../fetcher/SparkRestClient.scala.html#L229" title="com/microsoft/spark/insight/fetcher/SparkRestClient.scala:229">get</a> user homePath to save Html file<br/>
&nbsp;&nbsp; */<br/>
&nbsp; val USER_HOME_PATH: String = System.<a href="../heuristics/ConfigurationHeuristic.scala.html#L48" title="com/microsoft/spark/insight/heuristics/ConfigurationHeuristic.scala:48">getProperty</a>(&quot;user.home&quot;)<br/>
<br/>
&nbsp; /**<br/>
&nbsp;&nbsp; * list of metrics to be included in pie chart<br/>
&nbsp;&nbsp; */<br/>
&nbsp; val PIE_METRICS_LIST: Seq[<a href="../utils/PerfMetric.scala.html#L17" title="com/microsoft/spark/insight/utils/PerfMetric.scala:17">PerfMetric</a>] =<br/>
&nbsp; &nbsp; Seq(SHUFFLE_READ_FETCH_WAIT_TIME, SHUFFLE_WRITE_TIME, EXECUTOR_CPU_TIME, NET_IO_TIME, JVM_GC_TIME)<br/>
<br/>
&nbsp; /**<br/>
&nbsp;&nbsp; * List of metrics available in <a href="../utils/spark/PerStageReport.scala.html#L26" title="com/microsoft/spark/insight/utils/spark/PerStageReport.scala:26">stage</a> report.<br/>
&nbsp;&nbsp; */<br/>
&nbsp; val STAGE_METRICS_LIST: Seq[<a href="../utils/PerfMetric.scala.html#L17" title="com/microsoft/spark/insight/utils/PerfMetric.scala:17">PerfMetric</a>] =<br/>
&nbsp; &nbsp; MILLIS_TO_MINUTES_PERF_METRICS ++ TO_THOUSANDS_PERF_METRICS ++ BYTES_TO_GB_PERF_METRICS<br/>
<br/>
&nbsp; /**<br/>
&nbsp;&nbsp; * The precision to which perfValues have to be displayed in GridBench Html<br/>
&nbsp;&nbsp; */<br/>
&nbsp; val PERF_VALUE_PRECISION_HTML = 4<br/>
<br/>
&nbsp; /**<br/>
&nbsp;&nbsp; * Number of <a href="../heuristics/HeuristicResult.scala.html#L25" title="com/microsoft/spark/insight/heuristics/HeuristicResult.scala:25">rows</a> to be displayed in Html if limited <a href="../heuristics/HeuristicResult.scala.html#L25" title="com/microsoft/spark/insight/heuristics/HeuristicResult.scala:25">rows</a> are to be displayed.<br/>
&nbsp;&nbsp; *<br/>
&nbsp;&nbsp; * This is not used for tables showing all perfMetrics and their values (example: Summary Report)<br/>
&nbsp;&nbsp; */<br/>
&nbsp; val NO_OF_TABLE_ROWS_HTML = 10<br/>
<br/>
&nbsp; /**<br/>
&nbsp;&nbsp; * Number of sectors to be displayed in Html if limited sectors are to be displayed.<br/>
&nbsp;&nbsp; */<br/>
&nbsp; val NO_OF_PIE_SECTORS = 10<br/>
}<br/>
</code>

 </body>
</html>
