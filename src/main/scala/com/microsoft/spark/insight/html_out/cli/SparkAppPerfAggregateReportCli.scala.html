<!-- generated by the src2html.pl tool from code2ebook:
  https://github.com/agentzh/code2ebook
-->

<html>
 <head>
  <title>cli/SparkAppPerfAggregateReportCli.scala - Spark Insight</title>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
  <style>
body {
    text-align: left;
    text-align-last: left;
}

code {
    font-family: consolas, monospace;
    line-height: 130%;
}


  </style>
 </head>
 <body>

  <h1>cli/SparkAppPerfAggregateReportCli.scala - Spark Insight</h1>
 <h2>Data types defined</h2>
 <ul class="toc">
<li><a href="#L11">SparkAppPerfAggregateReportCli</a></li>
<li><a href="#L84">SparkAppPerfAggregateReportCli</a></li>
</ul>
 <h2>Functions defined</h2>
 <ul class="toc">
<li><a href="#L92">apply</a></li>
</ul>
 <h2>Source code</h2>

  <code>package com.microsoft.spark.insight.cli<br/>
<br/>
import com.microsoft.spark.insight.cli.frontend._<br/>
import com.microsoft.spark.insight.html.<a href="../html/SparkAppHtmlUtils.scala.html#L22" title="html/SparkAppHtmlUtils.scala:22">SparkAppHtmlUtils</a>.<a href="../html/SparkAppHtmlUtils.scala.html#L31" title="html/SparkAppHtmlUtils.scala:31">writeAndOpenHtml</a><br/>
import com.microsoft.spark.insight.utils.<a href="../utils/AggregatePerfValue.scala.html#L6" title="utils/AggregatePerfValue.scala:6">AggregatePerfValue</a><br/>
import com.microsoft.spark.insight.utils.spark.<a href="../utils/spark/SparkAppPerfAggregateReport.scala.html#L17" title="utils/spark/SparkAppPerfAggregateReport.scala:17">SparkAppPerfAggregateReport</a><br/>
<br/>
/**<br/>
 * Generate an aggregated performance report given a set of Spark application runs<br/>
 */<br/>
<a id="L11">&#x200c;</a>private[cli] class <span class="linkable">SparkAppPerfAggregateReportCli</span> private (withStages: Boolean)<br/>
&nbsp; &nbsp; extends <a href="PerfMetricsReport.scala.html#L149" title="cli/PerfMetricsReport.scala:149">PerfMetricsReport</a>[<a href="../utils/AggregatePerfValue.scala.html#L6" title="utils/AggregatePerfValue.scala:6">AggregatePerfValue</a>](withStages)<br/>
&nbsp; &nbsp; with <a href="ReportCli.scala.html#L10" title="cli/ReportCli.scala:10">ReportCli</a>[<a href="AppIdSets.scala.html#L22" title="cli/AppIdSets.scala:22">AppIdSet</a>] {<br/>
<br/>
&nbsp; override def <a href="PerfMetricsReport.scala.html#L33" title="cli/PerfMetricsReport.scala:33">headerDefinition</a>: Array[String] =<br/>
&nbsp; &nbsp; Array(&quot;Metric&quot;, &quot;Min&quot;, &quot;Max&quot;, &quot;Median&quot;, &quot;Mean&quot;, &quot;Stddev&quot;, &quot;Metric <a href="../fetcher/status/statusapiv1.scala.html#L106" title="fetcher/status/statusapiv1.scala:106">description</a>&quot;)<br/>
<br/>
&nbsp; /**<br/>
&nbsp;&nbsp; * Generate Text version of aggregated Spark performance report given a set of<br/>
&nbsp;&nbsp; * [[com.microsoft.spark.insight.utils.spark.<a href="../utils/spark/SparkAppPerfReport.scala.html#L26" title="utils/spark/SparkAppPerfReport.scala:26">SparkAppPerfReport</a>]], leveraging [[<a href="../utils/spark/SparkAppPerfAggregateReport.scala.html#L17" title="utils/spark/SparkAppPerfAggregateReport.scala:17">SparkAppPerfAggregateReport</a>]]<br/>
&nbsp;&nbsp; *<br/>
&nbsp;&nbsp; * @param appReportSet a set of [[com.microsoft.spark.insight.utils.spark.<a href="../utils/spark/SparkAppPerfReport.scala.html#L26" title="utils/spark/SparkAppPerfReport.scala:26">SparkAppPerfReport</a>]]s<br/>
&nbsp;&nbsp; * @return performance report<br/>
&nbsp;&nbsp; */<br/>
&nbsp; override protected def <a href="TextReport.scala.html#L35" title="cli/TextReport.scala:35">genTextReportBody</a>[U &lt;: <a href="AppReportSets.scala.html#L11" title="cli/AppReportSets.scala:11">AppReportSets</a>[<a href="AppIdSets.scala.html#L22" title="cli/AppIdSets.scala:22">AppIdSet</a>]](appReportSet: U): String = {<br/>
&nbsp; &nbsp; val sb = new StringBuilder()<br/>
&nbsp; &nbsp; val aggReport = new <a href="../utils/spark/SparkAppPerfAggregateReport.scala.html#L17" title="utils/spark/SparkAppPerfAggregateReport.scala:17">SparkAppPerfAggregateReport</a>(appReportSet.appReports)<br/>
<br/>
&nbsp; &nbsp; sb.<a href="frontend/CliTable.scala.html#L56" title="cli/frontend/CliTable.scala:56">append</a>(s&quot;\<a href="../utils/AggregatePerfValue.scala.html#L28" title="utils/AggregatePerfValue.scala:28">n</a>${<a href="ReportCli.scala.html#L10" title="cli/ReportCli.scala:10">ReportCli</a>.<a href="ReportCli.scala.html#L22" title="cli/ReportCli.scala:22">firstLineNote</a>}\<a href="../utils/AggregatePerfValue.scala.html#L28" title="utils/AggregatePerfValue.scala:28">n</a>\<a href="../utils/AggregatePerfValue.scala.html#L28" title="utils/AggregatePerfValue.scala:28">n</a>&quot;)<br/>
&nbsp; &nbsp; sb.<a href="frontend/CliTable.scala.html#L56" title="cli/frontend/CliTable.scala:56">append</a>(s&quot;Aggregated Performance Report for Spark applications: ${appReportSet.toString}\<a href="../utils/AggregatePerfValue.scala.html#L28" title="utils/AggregatePerfValue.scala:28">n</a>&quot;)<br/>
<br/>
&nbsp; &nbsp; sb.<a href="frontend/CliTable.scala.html#L56" title="cli/frontend/CliTable.scala:56">append</a>(s&quot;\nAggregated metrics summary for all Spark applications:\<a href="../utils/AggregatePerfValue.scala.html#L28" title="utils/AggregatePerfValue.scala:28">n</a>&quot;)<br/>
<br/>
&nbsp; &nbsp; val summaryTable = <a href="PerfMetricsReport.scala.html#L65" title="cli/PerfMetricsReport.scala:65">buildMetricsTable</a>(aggReport.<a href="../utils/spark/SparkAppPerfReportBase.scala.html#L63" title="utils/spark/SparkAppPerfReportBase.scala:63">summaryReport</a>, <a href="PerfMetricsReport.scala.html#L40" title="cli/PerfMetricsReport.scala:40">tableSummaryHeader</a>)<br/>
&nbsp; &nbsp; sb.<a href="frontend/CliTable.scala.html#L56" title="cli/frontend/CliTable.scala:56">append</a>(summaryTable)<br/>
&nbsp; &nbsp; sb.<a href="frontend/CliTable.scala.html#L56" title="cli/frontend/CliTable.scala:56">append</a>(String.<a href="../heuristics/StageAnalyzer.scala.html#L39" title="heuristics/StageAnalyzer.scala:39">format</a>(&quot;~&quot; * 166) + &quot;\<a href="../utils/AggregatePerfValue.scala.html#L28" title="utils/AggregatePerfValue.scala:28">n</a>&quot;)<br/>
<br/>
&nbsp; &nbsp; sb.<a href="frontend/CliTable.scala.html#L56" title="cli/frontend/CliTable.scala:56">append</a>(<br/>
&nbsp; &nbsp; &nbsp; <a href="PerfMetricsReport.scala.html#L101" title="cli/PerfMetricsReport.scala:101">buildPerStageTables</a>(<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &quot;Metrics for individual jobs&quot;,<br/>
&nbsp; &nbsp; &nbsp; &nbsp; aggReport.<a href="../utils/spark/SparkAppPerfReportBase.scala.html#L70" title="utils/spark/SparkAppPerfReportBase.scala:70">jobLevelReport</a>,<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &quot;Metrics for individual stages&quot;,<br/>
&nbsp; &nbsp; &nbsp; &nbsp; aggReport.<a href="../utils/spark/SparkAppPerfReportBase.scala.html#L56" title="utils/spark/SparkAppPerfReportBase.scala:56">perJobReport</a>))<br/>
&nbsp; &nbsp; sb.<a href="frontend/CliTable.scala.html#L56" title="cli/frontend/CliTable.scala:56">append</a>(<a href="ReportCli.scala.html#L10" title="cli/ReportCli.scala:10">ReportCli</a>.<a href="ReportCli.scala.html#L30" title="cli/ReportCli.scala:30">htmlNote</a>)<br/>
<br/>
&nbsp; &nbsp; sb.toString<br/>
&nbsp; }<br/>
<br/>
&nbsp; override protected def <a href="PerfMetricsReport.scala.html#L26" title="cli/PerfMetricsReport.scala:26">buildPerfTableRowValues</a>(<br/>
&nbsp; &nbsp; &nbsp; <a href="../fetcher/status/statusapiv1.scala.html#L305" title="fetcher/status/statusapiv1.scala:305">value</a>: <a href="../utils/AggregatePerfValue.scala.html#L6" title="utils/AggregatePerfValue.scala:6">AggregatePerfValue</a>,<br/>
&nbsp; &nbsp; &nbsp; transformer: Double =&gt; String): Array[String] =<br/>
&nbsp; &nbsp; Array(<br/>
&nbsp; &nbsp; &nbsp; transformer(<a href="../fetcher/status/statusapiv1.scala.html#L305" title="fetcher/status/statusapiv1.scala:305">value</a>.<a href="../utils/AggregatePerfValue.scala.html#L24" title="utils/AggregatePerfValue.scala:24">min</a>),<br/>
&nbsp; &nbsp; &nbsp; transformer(<a href="../fetcher/status/statusapiv1.scala.html#L305" title="fetcher/status/statusapiv1.scala:305">value</a>.<a href="../utils/AggregatePerfValue.scala.html#L26" title="utils/AggregatePerfValue.scala:26">max</a>),<br/>
&nbsp; &nbsp; &nbsp; transformer(<a href="../fetcher/status/statusapiv1.scala.html#L305" title="fetcher/status/statusapiv1.scala:305">value</a>.<a href="../utils/AggregatePerfValue.scala.html#L14" title="utils/AggregatePerfValue.scala:14">percentile</a>(50)),<br/>
&nbsp; &nbsp; &nbsp; transformer(<a href="../fetcher/status/statusapiv1.scala.html#L305" title="fetcher/status/statusapiv1.scala:305">value</a>.<a href="../utils/AggregatePerfValue.scala.html#L18" title="utils/AggregatePerfValue.scala:18">mean</a>),<br/>
&nbsp; &nbsp; &nbsp; transformer(<a href="../fetcher/status/statusapiv1.scala.html#L305" title="fetcher/status/statusapiv1.scala:305">value</a>.<a href="../utils/AggregatePerfValue.scala.html#L22" title="utils/AggregatePerfValue.scala:22">stddev</a>))<br/>
<br/>
&nbsp; /**<br/>
&nbsp;&nbsp; * Generate Html version of aggregated Spark performance report given a set of<br/>
&nbsp;&nbsp; * [[com.microsoft.spark.insight.utils.spark.<a href="../utils/spark/SparkAppPerfReport.scala.html#L26" title="utils/spark/SparkAppPerfReport.scala:26">SparkAppPerfReport</a>]], leveraging [[<a href="../utils/spark/SparkAppPerfAggregateReport.scala.html#L17" title="utils/spark/SparkAppPerfAggregateReport.scala:17">SparkAppPerfAggregateReport</a>]]<br/>
&nbsp;&nbsp; *<br/>
&nbsp;&nbsp; * @param appReportSet a collection of [[com.microsoft.spark.insight.utils.spark.<a href="../utils/spark/SparkAppPerfReport.scala.html#L26" title="utils/spark/SparkAppPerfReport.scala:26">SparkAppPerfReport</a>]]s<br/>
&nbsp;&nbsp; * @return String containing path to Html File.<br/>
&nbsp;&nbsp; */<br/>
&nbsp; override protected def <a href="HtmlReport.scala.html#L35" title="cli/HtmlReport.scala:35">genHtmlReportFile</a>[U &lt;: <a href="AppReportSets.scala.html#L11" title="cli/AppReportSets.scala:11">AppReportSets</a>[<a href="AppIdSets.scala.html#L22" title="cli/AppIdSets.scala:22">AppIdSet</a>]](appReportSet: U): String = {<br/>
&nbsp; &nbsp; val sb = new StringBuilder()<br/>
&nbsp; &nbsp; val aggReport = new <a href="../utils/spark/SparkAppPerfAggregateReport.scala.html#L17" title="utils/spark/SparkAppPerfAggregateReport.scala:17">SparkAppPerfAggregateReport</a>(appReportSet.appReports)<br/>
<br/>
&nbsp; &nbsp; sb.<a href="frontend/CliTable.scala.html#L56" title="cli/frontend/CliTable.scala:56">append</a>(s&quot;\nAggregated Performance Report for Spark applications: ${appReportSet.toString}\<a href="../utils/AggregatePerfValue.scala.html#L28" title="utils/AggregatePerfValue.scala:28">n</a>&quot;)<br/>
<br/>
&nbsp; &nbsp; // <a href="../html/SparkAppHtmlUtils.scala.html#L31" title="html/SparkAppHtmlUtils.scala:31">writeAndOpenHtml</a> creates a new views.html file named '<a href="../utils/spark/RawSparkMetrics.scala.html#L31" title="utils/spark/RawSparkMetrics.scala:31">appId</a>',<br/>
&nbsp; &nbsp; // writes the rendered views.html output, opens file in browser and returns path to file<br/>
&nbsp; &nbsp; try {<br/>
&nbsp; &nbsp; &nbsp; val htmlFilePath = &quot;empty&quot;<br/>
&nbsp; &nbsp; &nbsp; sb.<a href="frontend/CliTable.scala.html#L56" title="cli/frontend/CliTable.scala:56">append</a>(s&quot;\nHTML report was written to: $htmlFilePath&quot;.<a href="frontend/package.scala.html#L39" title="cli/frontend/package.scala:39">blue</a>.<a href="frontend/package.scala.html#L57" title="cli/frontend/package.scala:57">bold</a>)<br/>
&nbsp; &nbsp; } catch {<br/>
&nbsp; &nbsp; &nbsp; case e: Exception =&gt; sb.<a href="frontend/CliTable.scala.html#L56" title="cli/frontend/CliTable.scala:56">append</a>(s&quot;\nGenerating Html report failed. Reason: $e&quot;)<br/>
&nbsp; &nbsp; }<br/>
&nbsp; &nbsp; sb.toString<br/>
&nbsp; }<br/>
}<br/>
<br/>
<a id="L84">&#x200c;</a>object <span class="linkable">SparkAppPerfAggregateReportCli</span> {<br/>
<br/>
&nbsp; /**<br/>
&nbsp;&nbsp; * The public API to build aggregated app performance report given a set of Spark applications<br/>
&nbsp;&nbsp; *<br/>
&nbsp;&nbsp; * @param withStages true or false to show per-stages metrics<br/>
&nbsp;&nbsp; * @return a cli instance used to generate aggregated app performance report<br/>
&nbsp;&nbsp; */<br/>
<a id="L92">&#x200c;</a>&nbsp; def <span class="linkable">apply</span>(withStages: Boolean): <a href="#L11" title="cli/SparkAppPerfAggregateReportCli.scala:11">SparkAppPerfAggregateReportCli</a> = new <a href="#L11" title="cli/SparkAppPerfAggregateReportCli.scala:11">SparkAppPerfAggregateReportCli</a>(withStages)<br/>
}<br/>
</code>

 </body>
</html>
