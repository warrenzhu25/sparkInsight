<!-- generated by the src2html.pl tool from code2ebook:
  https://github.com/agentzh/code2ebook
-->

<html>
 <head>
  <title>cli/frontend/CliTable.scala - Spark Insight</title>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
  <style>
body {
    text-align: left;
    text-align-last: left;
}

code {
    font-family: consolas, monospace;
    line-height: 130%;
}


  </style>
 </head>
 <body>

  <h1>cli/frontend/CliTable.scala - Spark Insight</h1>
 <h2>Data types defined</h2>
 <ul class="toc">
<li><a href="#L113">CliTable</a></li>
<li><a href="#L52">TableBuilder</a></li>
</ul>
 <h2>Functions defined</h2>
 <ul class="toc">
<li><a href="#L56">append</a></li>
<li><a href="#L152">create</a></li>
<li><a href="#L127">createWithTextStyling</a></li>
<li><a href="#L102">pad</a></li>
<li><a href="#L72">printContent</a></li>
<li><a href="#L59">printDivider</a></li>
</ul>
 <h2>Source code</h2>

  <code>package com.microsoft.spark.insight.cli.frontend<br/>
<br/>
/**<br/>
 * Used for building a table from Array[String] with text style modifications<br/>
 */<br/>
private final class <a href="#L113" title="cli/frontend/CliTable.scala:113">CliTable</a>(<br/>
&nbsp; &nbsp; headers: Array[String],<br/>
&nbsp; &nbsp; dataRows: Array[Array[String]],<br/>
&nbsp; &nbsp; headerStyling: Map[Int, Seq[<a href="TextStyling.scala.html#L8" title="cli/frontend/TextStyling.scala:8">TextStyling</a>]],<br/>
&nbsp; &nbsp; dataStyling: Map[(Int, Int), Seq[<a href="TextStyling.scala.html#L8" title="cli/frontend/TextStyling.scala:8">TextStyling</a>]]) {<br/>
<br/>
&nbsp; private val nCol: Int = headers.length<br/>
<br/>
&nbsp; // Maintain the width of each column in the table<br/>
&nbsp; private val colWidths: Array[Int] = new Array[Int](nCol)<br/>
<br/>
&nbsp; // Trying to <a href="../../heuristics/ConfigurationHeuristic.scala.html#L47" title="heuristics/ConfigurationHeuristic.scala:47">evaluate</a> the width of every column, by finding the maximum width of all cells in a column<br/>
&nbsp; for {<br/>
&nbsp; &nbsp; row &lt;- headers +: dataRows<br/>
&nbsp; &nbsp; col &lt;- 0 until nCol<br/>
&nbsp; &nbsp; cell &lt;- row(col).split(&quot;\\<a href="../../utils/AggregatePerfValue.scala.html#L28" title="utils/AggregatePerfValue.scala:28">n</a>&quot;)<br/>
&nbsp; } {<br/>
&nbsp; &nbsp; colWidths(col) = Math.<a href="../../utils/AggregatePerfValue.scala.html#L26" title="utils/AggregatePerfValue.scala:26">max</a>(colWidths(col), cell.length)<br/>
&nbsp; }<br/>
<br/>
&nbsp; /**<br/>
&nbsp;&nbsp; * Print the Table by overriding toString method<br/>
&nbsp;&nbsp; * @return formatted string table<br/>
&nbsp;&nbsp; */<br/>
&nbsp; override def toString: String = {<br/>
&nbsp; &nbsp; val builder = new <a href="#L52" title="cli/frontend/CliTable.scala:52">TableBuilder</a>(new StringBuilder)<br/>
&nbsp; &nbsp; builder.<a href="#L56" title="cli/frontend/CliTable.scala:56">append</a>(&quot;\<a href="../../utils/AggregatePerfValue.scala.html#L28" title="utils/AggregatePerfValue.scala:28">n</a>&quot;)<br/>
&nbsp; &nbsp; builder.<a href="#L59" title="cli/frontend/CliTable.scala:59">printDivider</a>(<a href="TableDividerFormat.scala.html#L7" title="cli/frontend/TableDividerFormat.scala:7">TableDividerFormat</a>.headerTopFormat)<br/>
&nbsp; &nbsp; builder.<a href="#L72" title="cli/frontend/CliTable.scala:72">printContent</a>(headers, 0, isHeader = true)<br/>
&nbsp; &nbsp; for (rowIndex &lt;- dataRows.indices) {<br/>
<br/>
&nbsp; &nbsp; &nbsp; if (rowIndex == 0) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; builder.<a href="#L59" title="cli/frontend/CliTable.scala:59">printDivider</a>(<a href="TableDividerFormat.scala.html#L7" title="cli/frontend/TableDividerFormat.scala:7">TableDividerFormat</a>.headerBottomFormat)<br/>
&nbsp; &nbsp; &nbsp; } else {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; builder.<a href="#L59" title="cli/frontend/CliTable.scala:59">printDivider</a>(<a href="TableDividerFormat.scala.html#L7" title="cli/frontend/TableDividerFormat.scala:7">TableDividerFormat</a>.dataRowFormat)<br/>
&nbsp; &nbsp; &nbsp; }<br/>
<br/>
&nbsp; &nbsp; &nbsp; builder.<a href="#L72" title="cli/frontend/CliTable.scala:72">printContent</a>(dataRows(rowIndex), rowIndex, isHeader = false)<br/>
&nbsp; &nbsp; }<br/>
&nbsp; &nbsp; builder.<a href="#L59" title="cli/frontend/CliTable.scala:59">printDivider</a>(<a href="TableDividerFormat.scala.html#L7" title="cli/frontend/TableDividerFormat.scala:7">TableDividerFormat</a>.dataRowBottomFormat)<br/>
&nbsp; &nbsp; builder.toString<br/>
&nbsp; }<br/>
<br/>
&nbsp; /**<br/>
&nbsp;&nbsp; * Table string builder. Also Used for clear abstraction of <a href="#L113" title="cli/frontend/CliTable.scala:113">CliTable</a> construction.<br/>
&nbsp;&nbsp; */<br/>
<a id="L52">&#x200c;</a>&nbsp; final class <span class="linkable">TableBuilder</span>(builder: StringBuilder) {<br/>
<br/>
&nbsp; &nbsp; require(builder != null, &quot;string builder cannot be null.&quot;)<br/>
<br/>
<a id="L56">&#x200c;</a>&nbsp; &nbsp; def <span class="linkable">append</span>(s: Any): StringBuilder = builder.<span class="linkable">append</span>(s)<br/>
<br/>
&nbsp; &nbsp; // Print divider of the Table<br/>
<a id="L59">&#x200c;</a>&nbsp; &nbsp; def <span class="linkable">printDivider</span>(<a href="../../heuristics/StageAnalyzer.scala.html#L39" title="heuristics/StageAnalyzer.scala:39">format</a>: <a href="TableDividerFormat.scala.html#L7" title="cli/frontend/TableDividerFormat.scala:7">TableDividerFormat</a>): Unit = {<br/>
&nbsp; &nbsp; &nbsp; for (col &lt;- 0 until nCol) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; if (col == 0) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L56" title="cli/frontend/CliTable.scala:56">append</a>(<a href="../../heuristics/StageAnalyzer.scala.html#L39" title="heuristics/StageAnalyzer.scala:39">format</a>.<a href="TableDividerFormat.scala.html#L10" title="cli/frontend/TableDividerFormat.scala:10">leftBorder</a>)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; } else {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L56" title="cli/frontend/CliTable.scala:56">append</a>(<a href="../../heuristics/StageAnalyzer.scala.html#L39" title="heuristics/StageAnalyzer.scala:39">format</a>.<a href="TableDividerFormat.scala.html#L12" title="cli/frontend/TableDividerFormat.scala:12">middleBoundary</a>)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L56" title="cli/frontend/CliTable.scala:56">append</a>(<a href="#L102" title="cli/frontend/CliTable.scala:102">pad</a>(colWidths(col), &quot;&quot;).replace(' ', <a href="../../heuristics/StageAnalyzer.scala.html#L39" title="heuristics/StageAnalyzer.scala:39">format</a>.<a href="TableDividerFormat.scala.html#L14" title="cli/frontend/TableDividerFormat.scala:14">horizontalDiv</a>))<br/>
&nbsp; &nbsp; &nbsp; }<br/>
&nbsp; &nbsp; &nbsp; <a href="#L56" title="cli/frontend/CliTable.scala:56">append</a>(<a href="../../heuristics/StageAnalyzer.scala.html#L39" title="heuristics/StageAnalyzer.scala:39">format</a>.<a href="TableDividerFormat.scala.html#L16" title="cli/frontend/TableDividerFormat.scala:16">rightBorder</a>).<a href="#L56" title="cli/frontend/CliTable.scala:56">append</a>('\<a href="../../utils/AggregatePerfValue.scala.html#L28" title="utils/AggregatePerfValue.scala:28">n</a>')<br/>
&nbsp; &nbsp; }<br/>
<br/>
&nbsp; &nbsp; // Print one cell of the Table, either one <a href="../../heuristics/HeuristicResult.scala.html#L24" title="heuristics/HeuristicResult.scala:24">header</a> or one cell of data<br/>
<a id="L72">&#x200c;</a>&nbsp; &nbsp; def <span class="linkable">printContent</span>(cell: Seq[String], rowIndex: Int, isHeader: Boolean): Unit = {<br/>
<br/>
&nbsp; &nbsp; &nbsp; // Find out the maximum of lines for any column data in this row<br/>
&nbsp; &nbsp; &nbsp; val maxCellLine: Int = cell.map(_.split(&quot;\\<a href="../../utils/AggregatePerfValue.scala.html#L28" title="utils/AggregatePerfValue.scala:28">n</a>&quot;).length).<a href="../../utils/AggregatePerfValue.scala.html#L26" title="utils/AggregatePerfValue.scala:26">max</a><br/>
<br/>
&nbsp; &nbsp; &nbsp; for (line &lt;- 0 until maxCellLine) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; for (colIndex &lt;- 0 until nCol) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L56" title="cli/frontend/CliTable.scala:56">append</a>(if (colIndex == 0) <a href="TableDividerFormat.scala.html#L7" title="cli/frontend/TableDividerFormat.scala:7">TableDividerFormat</a>.headerDivider else <a href="TableDividerFormat.scala.html#L7" title="cli/frontend/TableDividerFormat.scala:7">TableDividerFormat</a>.dataDivider)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; val cellLines: Array[String] = cell(colIndex).split(&quot;\\<a href="../../utils/AggregatePerfValue.scala.html#L28" title="utils/AggregatePerfValue.scala:28">n</a>&quot;)<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; val cellLine: String =<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (line &lt; cellLines.length) cellLines(line) else &quot;&quot;<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; val next = <a href="#L102" title="cli/frontend/CliTable.scala:102">pad</a>(colWidths(colIndex), cellLine)<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; val textStylingChanges: Seq[<a href="TextStyling.scala.html#L8" title="cli/frontend/TextStyling.scala:8">TextStyling</a>] = if (isHeader) {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; headerStyling.getOrElse(colIndex, <a href="#L113" title="cli/frontend/CliTable.scala:113">CliTable</a>.headerDefaultStyling)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } else {<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dataStyling.getOrElse((rowIndex, colIndex), <a href="#L113" title="cli/frontend/CliTable.scala:113">CliTable</a>.dataDefaultStyling)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br/>
<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; val colorString = <a href="TextStyling.scala.html#L8" title="cli/frontend/TextStyling.scala:8">TextStyling</a>.<a href="TextStyling.scala.html#L44" title="cli/frontend/TextStyling.scala:44">handleAll</a>((next, textStylingChanges))<br/>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="#L56" title="cli/frontend/CliTable.scala:56">append</a>(colorString)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; }<br/>
&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L56" title="cli/frontend/CliTable.scala:56">append</a>(<a href="TableDividerFormat.scala.html#L7" title="cli/frontend/TableDividerFormat.scala:7">TableDividerFormat</a>.headerDivider)<br/>
&nbsp; &nbsp; &nbsp; &nbsp; <a href="#L56" title="cli/frontend/CliTable.scala:56">append</a>(&quot;\<a href="../../utils/AggregatePerfValue.scala.html#L28" title="utils/AggregatePerfValue.scala:28">n</a>&quot;)<br/>
&nbsp; &nbsp; &nbsp; }<br/>
&nbsp; &nbsp; }<br/>
<br/>
&nbsp; &nbsp; // Format string with the specified width<br/>
<a id="L102">&#x200c;</a>&nbsp; &nbsp; private def <span class="linkable">pad</span>(width: Int, data: String): String = {<br/>
&nbsp; &nbsp; &nbsp; String.<a href="../../heuristics/StageAnalyzer.scala.html#L39" title="heuristics/StageAnalyzer.scala:39">format</a>(&quot; %1$-&quot; + width + &quot;s &quot;, data)<br/>
&nbsp; &nbsp; }<br/>
<br/>
&nbsp; &nbsp; override def toString: String = builder.toString<br/>
&nbsp; }<br/>
}<br/>
<br/>
/**<br/>
 * We provide two API for table creations<br/>
 */<br/>
<a id="L113">&#x200c;</a>object <span class="linkable">CliTable</span> {<br/>
<br/>
&nbsp; val headerDefaultStyling: Seq[<a href="TextStyling.scala.html#L8" title="cli/frontend/TextStyling.scala:8">TextStyling</a>] = Seq(<a href="TextStyling.scala.html#L8" title="cli/frontend/TextStyling.scala:8">TextStyling</a>(&quot;YELLOW&quot;), <a href="TextStyling.scala.html#L8" title="cli/frontend/TextStyling.scala:8">TextStyling</a>(&quot;BOLD&quot;))<br/>
&nbsp; val dataDefaultStyling: Seq[<a href="TextStyling.scala.html#L8" title="cli/frontend/TextStyling.scala:8">TextStyling</a>] = Seq(<a href="TextStyling.scala.html#L8" title="cli/frontend/TextStyling.scala:8">TextStyling</a>(&quot;BLACK&quot;))<br/>
<br/>
&nbsp; /**<br/>
&nbsp;&nbsp; * to <a href="#L152" title="cli/frontend/CliTable.scala:152">create</a> a Cli Table with customized text style<br/>
&nbsp;&nbsp; *<br/>
&nbsp;&nbsp; * @param headers table headers with the layout of Array[String]<br/>
&nbsp;&nbsp; * @param data table contents<br/>
&nbsp;&nbsp; * @param headerStyling text styling spec for headers<br/>
&nbsp;&nbsp; * @param dataStyling text styling spec for data with (row, col) coordinate<br/>
&nbsp;&nbsp; * @return formatted table with text styling settings<br/>
&nbsp;&nbsp; */<br/>
<a id="L127">&#x200c;</a>&nbsp; def <span class="linkable">createWithTextStyling</span>(<br/>
&nbsp; &nbsp; &nbsp; headers: Array[String],<br/>
&nbsp; &nbsp; &nbsp; data: Array[Array[String]],<br/>
&nbsp; &nbsp; &nbsp; headerStyling: Map[Int, Seq[<a href="TextStyling.scala.html#L8" title="cli/frontend/TextStyling.scala:8">TextStyling</a>]],<br/>
&nbsp; &nbsp; &nbsp; dataStyling: Map[(Int, Int), Seq[<a href="TextStyling.scala.html#L8" title="cli/frontend/TextStyling.scala:8">TextStyling</a>]]): String = {<br/>
<br/>
&nbsp; &nbsp; require(headers != null, &quot;Table headers cannot be null.&quot;)<br/>
&nbsp; &nbsp; require(headers.length &gt; 0, &quot;There must be at least 1 column.&quot;)<br/>
&nbsp; &nbsp; require(data != null, &quot;Table contents cannot be null&quot;)<br/>
<br/>
&nbsp; &nbsp; // Guarantee that <a href="../../heuristics/HeuristicResult.scala.html#L24" title="heuristics/HeuristicResult.scala:24">header</a> and all data has the same length of data<br/>
&nbsp; &nbsp; require(<br/>
&nbsp; &nbsp; &nbsp; data.forall(_.length == headers.length),<br/>
&nbsp; &nbsp; &nbsp; &quot;Header column number should align with every row in Table content.&quot;)<br/>
<br/>
&nbsp; &nbsp; new <a href="#L113" title="cli/frontend/CliTable.scala:113">CliTable</a>(headers, data, headerStyling, dataStyling).toString()<br/>
&nbsp; }<br/>
<br/>
&nbsp; /**<br/>
&nbsp;&nbsp; * to <a href="#L152" title="cli/frontend/CliTable.scala:152">create</a> a Cli Table with default color <a href="../../heuristics/StageAnalyzer.scala.html#L39" title="heuristics/StageAnalyzer.scala:39">format</a><br/>
&nbsp;&nbsp; *<br/>
&nbsp;&nbsp; * @param headers table headers with the layout of Array[String]<br/>
&nbsp;&nbsp; * @param data table contents<br/>
&nbsp;&nbsp; * @return formatted table with default text styling settings<br/>
&nbsp;&nbsp; */<br/>
<a id="L152">&#x200c;</a>&nbsp; def <span class="linkable">create</span>(headers: Array[String], data: Array[Array[String]]): String = {<br/>
&nbsp; &nbsp; <a href="#L127" title="cli/frontend/CliTable.scala:127">createWithTextStyling</a>(headers, data, Map.empty, Map.empty)<br/>
&nbsp; }<br/>
}<br/>
</code>

 </body>
</html>
