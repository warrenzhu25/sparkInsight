<!-- generated by the src2html.pl tool from code2ebook:
  https://github.com/agentzh/code2ebook
-->

<html>
 <head>
  <title>utils/spark/PerJobReport.scala - Spark Insight</title>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
  <style>
body {
    text-align: left;
    text-align-last: left;
}

code {
    font-family: consolas, monospace;
    line-height: 130%;
}


  </style>
 </head>
 <body>

  <h1>utils/spark/PerJobReport.scala - Spark Insight</h1>
 <h2>Data types defined</h2>
 <ul class="toc">
<li><a href="#L19">PerJobReport</a></li>
<li><a href="#L81">PerJobReport</a></li>
</ul>
 <h2>Functions defined</h2>
 <ul class="toc">
<li><a href="#L55">allJobs</a></li>
<li><a href="#L93">apply</a></li>
<li><a href="#L67">doIfValid</a></li>
<li><a href="#L33">failure</a></li>
<li><a href="#L40">isValid</a></li>
<li><a href="#L48">job</a></li>
<li><a href="#L62">jobKeys</a></li>
</ul>
 <h2>Source code</h2>

  <code>package com.microsoft.spark.insight.utils.spark<br/>
<br/>
import com.microsoft.spark.insight.utils._<br/>
<br/>
import scala.collection.immutable.ListMap<br/>
import scala.util.{Failure, Success, Try}<br/>
<br/>
/**<br/>
 * A container for a set of jobs, indexed by their [[JobKey]] and coupled with their corresponding [[<a href="PerStageReport.scala.html#L15" title="utils/spark/PerStageReport.scala:15">PerStageReport</a>]]s<br/>
 * that contains a set of metrics per-<a href="PerStageReport.scala.html#L26" title="utils/spark/PerStageReport.scala:26">stage</a>. This is a private constructor. Callers should use the <a href="../../cli/AppReportSets.scala.html#L43" title="cli/AppReportSets.scala:43">apply</a>() method for<br/>
 * instantiating.<br/>
 *<br/>
 * @param exception an exception, in case one was thrown during construction of the input<br/>
 * @param jobs a sequence of jobs and their stages, coupled with a per-<a href="PerStageReport.scala.html#L26" title="utils/spark/PerStageReport.scala:26">stage</a> [[PerfMetricsType]]<br/>
 * @tparam JobKey the unique identifier to be used for jobs<br/>
 * @tparam StageKey the unique identifier to be used for stages<br/>
 * @tparam PerfMetricsType the type of [[<a href="SparkAppPerfReport.scala.html#L145" title="utils/spark/SparkAppPerfReport.scala:145">PerfMetrics</a>]] object to be used, per-<a href="PerStageReport.scala.html#L26" title="utils/spark/PerStageReport.scala:26">stage</a><br/>
 */<br/>
<a id="L19">&#x200c;</a>class <span class="linkable">PerJobReport</span>[JobKey, StageKey, PerfMetricsType &lt;: <a href="SparkAppPerfReport.scala.html#L145" title="utils/spark/SparkAppPerfReport.scala:145">PerfMetrics</a>[Any]] private (<br/>
&nbsp; &nbsp; exception: Option[Throwable],<br/>
&nbsp; &nbsp; jobs: Seq[(JobKey, <a href="PerStageReport.scala.html#L15" title="utils/spark/PerStageReport.scala:15">PerStageReport</a>[StageKey, PerfMetricsType])])<br/>
&nbsp; &nbsp; extends Iterable[(JobKey, <a href="PerStageReport.scala.html#L15" title="utils/spark/PerStageReport.scala:15">PerStageReport</a>[StageKey, PerfMetricsType])] {<br/>
&nbsp; private val _failure = exception<br/>
<br/>
&nbsp; // Use a ListMap to preserve <a href="SparkAppReportMatcher.scala.html#L172" title="utils/spark/SparkAppReportMatcher.scala:172">ordering</a> of entries<br/>
&nbsp; private val _jobMap: Map[JobKey, <a href="PerStageReport.scala.html#L15" title="utils/spark/PerStageReport.scala:15">PerStageReport</a>[StageKey, PerfMetricsType]] = ListMap(jobs: _*)<br/>
<br/>
&nbsp; /**<br/>
&nbsp;&nbsp; * Retrieve the exception that occurred during construction, if any<br/>
&nbsp;&nbsp; *<br/>
&nbsp;&nbsp; * @return the exception or null if there was not <a href="#L33" title="utils/spark/PerJobReport.scala:33">failure</a><br/>
&nbsp;&nbsp; */<br/>
<a id="L33">&#x200c;</a>&nbsp; def <span class="linkable">failure</span>: Throwable = _failure.orNull<br/>
<br/>
&nbsp; /**<br/>
&nbsp;&nbsp; * Check whether the report was generated without failures<br/>
&nbsp;&nbsp; *<br/>
&nbsp;&nbsp; * @return 'true' if there were no failures, else 'false'<br/>
&nbsp;&nbsp; */<br/>
<a id="L40">&#x200c;</a>&nbsp; def <span class="linkable">isValid</span>: Boolean = _failure.isEmpty<br/>
<br/>
&nbsp; /**<br/>
&nbsp;&nbsp; * Retrieve the [[<a href="PerStageReport.scala.html#L15" title="utils/spark/PerStageReport.scala:15">PerStageReport</a>]] for a particular [[JobKey]]<br/>
&nbsp;&nbsp; *<br/>
&nbsp;&nbsp; * @param jobKey jobKey to <a href="../../cli/AppReportSets.scala.html#L44" title="cli/AppReportSets.scala:44">retrieve</a> the report for<br/>
&nbsp;&nbsp; * @return the <a href="PerStageReport.scala.html#L15" title="utils/spark/PerStageReport.scala:15">PerStageReport</a> object associated with this [[JobKey]]<br/>
&nbsp;&nbsp; */<br/>
<a id="L48">&#x200c;</a>&nbsp; def <span class="linkable">job</span>(jobKey: JobKey): <a href="PerStageReport.scala.html#L15" title="utils/spark/PerStageReport.scala:15">PerStageReport</a>[StageKey, PerfMetricsType] = <a href="#L67" title="utils/spark/PerJobReport.scala:67">doIfValid</a>(() =&gt; _jobMap(jobKey))<br/>
<br/>
&nbsp; /**<br/>
&nbsp;&nbsp; * Retrieve all of the [[<a href="PerStageReport.scala.html#L15" title="utils/spark/PerStageReport.scala:15">PerStageReport</a>]]s associated with the set of jobs<br/>
&nbsp;&nbsp; *<br/>
&nbsp;&nbsp; * @return an iterator over the underlying [[<a href="PerStageReport.scala.html#L15" title="utils/spark/PerStageReport.scala:15">PerStageReport</a>]]s<br/>
&nbsp;&nbsp; */<br/>
<a id="L55">&#x200c;</a>&nbsp; def <span class="linkable">allJobs</span>: Iterable[<a href="PerStageReport.scala.html#L15" title="utils/spark/PerStageReport.scala:15">PerStageReport</a>[StageKey, PerfMetricsType]] = <a href="#L67" title="utils/spark/PerJobReport.scala:67">doIfValid</a>(() =&gt; _jobMap.values)<br/>
<br/>
&nbsp; /**<br/>
&nbsp;&nbsp; * Retrieve all of the [[JobKey]]s indexed in this collection<br/>
&nbsp;&nbsp; *<br/>
&nbsp;&nbsp; * @return an iterator over the <a href="#L62" title="utils/spark/PerJobReport.scala:62">jobKeys</a><br/>
&nbsp;&nbsp; */<br/>
<a id="L62">&#x200c;</a>&nbsp; def <span class="linkable">jobKeys</span>: Iterable[JobKey] = <a href="#L67" title="utils/spark/PerJobReport.scala:67">doIfValid</a>(() =&gt; _jobMap.keys)<br/>
<br/>
&nbsp; override def iterator: Iterator[(JobKey, <a href="PerStageReport.scala.html#L15" title="utils/spark/PerStageReport.scala:15">PerStageReport</a>[StageKey, PerfMetricsType])] =<br/>
&nbsp; &nbsp; <a href="#L67" title="utils/spark/PerJobReport.scala:67">doIfValid</a>(() =&gt; _jobMap.iterator)<br/>
<br/>
<a id="L67">&#x200c;</a>&nbsp; private def <span class="linkable">doIfValid</span>[T](f: () =&gt; T): T = if (<a href="#L40" title="utils/spark/PerJobReport.scala:40">isValid</a>) f.<a href="../../cli/AppReportSets.scala.html#L43" title="cli/AppReportSets.scala:43">apply</a>() else throw <a href="#L33" title="utils/spark/PerJobReport.scala:33">failure</a><br/>
<br/>
&nbsp; override def equals(other: Any): Boolean = other match {<br/>
&nbsp; &nbsp; case that: <a href="#L19" title="utils/spark/PerJobReport.scala:19">PerJobReport</a>[JobKey, StageKey, PerfMetricsType] =&gt;<br/>
&nbsp; &nbsp; &nbsp; _failure == that._failure &amp;&amp; _jobMap.equals(that._jobMap)<br/>
&nbsp; &nbsp; case _ =&gt; false<br/>
&nbsp; }<br/>
<br/>
&nbsp; override def hashCode(): Int = {<br/>
&nbsp; &nbsp; val state = Seq(_failure, _jobMap)<br/>
&nbsp; &nbsp; state.map(_.hashCode()).foldLeft(0)((a, b) =&gt; 31 * a + b)<br/>
&nbsp; }<br/>
}<br/>
<br/>
<a id="L81">&#x200c;</a>object <span class="linkable">PerJobReport</span> {<br/>
<br/>
&nbsp; /**<br/>
&nbsp;&nbsp; * Main entry point for this class<br/>
&nbsp;&nbsp; *<br/>
&nbsp;&nbsp; * @param jobsBuilder a lambda to construct the internal components to be collected by this object. May throw an<br/>
&nbsp;&nbsp; *&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exception<br/>
&nbsp;&nbsp; * @tparam JobKey the unique identifier to be used for jobs<br/>
&nbsp;&nbsp; * @tparam StageKey the unique identifier to be used for stages<br/>
&nbsp;&nbsp; * @tparam PerfMetricsType the type of [[<a href="SparkAppPerfReport.scala.html#L145" title="utils/spark/SparkAppPerfReport.scala:145">PerfMetrics</a>]] object to be used, per-<a href="PerStageReport.scala.html#L26" title="utils/spark/PerStageReport.scala:26">stage</a><br/>
&nbsp;&nbsp; * @return a <a href="#L19" title="utils/spark/PerJobReport.scala:19">PerJobReport</a> object<br/>
&nbsp;&nbsp; */<br/>
<a id="L93">&#x200c;</a>&nbsp; def <span class="linkable">apply</span>[JobKey, StageKey, PerfMetricsType &lt;: <a href="SparkAppPerfReport.scala.html#L145" title="utils/spark/SparkAppPerfReport.scala:145">PerfMetrics</a>[Any]](<br/>
&nbsp; &nbsp; &nbsp; jobsBuilder: () =&gt; Seq[(JobKey, Seq[(StageKey, PerfMetricsType)])])<br/>
&nbsp; &nbsp; &nbsp; : <a href="#L19" title="utils/spark/PerJobReport.scala:19">PerJobReport</a>[JobKey, StageKey, PerfMetricsType] = {<br/>
&nbsp; &nbsp; Try(jobsBuilder.<a href="../../cli/AppReportSets.scala.html#L43" title="cli/AppReportSets.scala:43">apply</a>()) match {<br/>
&nbsp; &nbsp; &nbsp; case Failure(exception) =&gt; new <a href="#L19" title="utils/spark/PerJobReport.scala:19">PerJobReport</a>(Option(exception), Seq.empty)<br/>
&nbsp; &nbsp; &nbsp; case Success(jobs) =&gt;<br/>
&nbsp; &nbsp; &nbsp; &nbsp; new <a href="#L19" title="utils/spark/PerJobReport.scala:19">PerJobReport</a>(None, jobs.map { case (jobKey, perStageSeq) =&gt; (jobKey, new <a href="PerStageReport.scala.html#L15" title="utils/spark/PerStageReport.scala:15">PerStageReport</a>(perStageSeq)) })<br/>
&nbsp; &nbsp; }<br/>
&nbsp; }<br/>
}<br/>
</code>

 </body>
</html>
